import base64,sys;exec(base64.b64decode({2:str,3:lambda b:bytes(b,'UTF-8')}[sys.version_info[0]]('IyEvdXNyL2Jpbi9weXRob24KIyB2aW06IHRhYnN0b3A9NCBzb2Z0dGFic3RvcD00IHNoaWZ0d2lkdGg9NCBub2V4cGFuZHRhYgppbXBvcnQgYmluYXNjaWkKaW1wb3J0IGNvZGUKaW1wb3J0IG9zCmltcG9ydCBwbGF0Zm9ybQppbXBvcnQgcmFuZG9tCmltcG9ydCByZQppbXBvcnQgc2VsZWN0CmltcG9ydCBzb2NrZXQKaW1wb3J0IHN0cnVjdAppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgc3lzCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHRpbWUKaW1wb3J0IHRyYWNlYmFjawoKdHJ5OgoJaW1wb3J0IGN0eXBlcwpleGNlcHQgSW1wb3J0RXJyb3I6CgloYXNfd2luZGxsID0gRmFsc2UKZWxzZToKCWhhc193aW5kbGwgPSBoYXNhdHRyKGN0eXBlcywgJ3dpbmRsbCcpCgp0cnk6Cgl1cmxsaWJfaW1wb3J0cyA9IFsnUHJveHlIYW5kbGVyJywgJ1JlcXVlc3QnLCAnYnVpbGRfb3BlbmVyJywgJ2luc3RhbGxfb3BlbmVyJywgJ3VybG9wZW4nXQoJaWYgc3lzLnZlcnNpb25faW5mb1swXSA8IDM6CgkJdXJsbGliID0gX19pbXBvcnRfXygndXJsbGliMicsIGZyb21saXN0PXVybGxpYl9pbXBvcnRzKQoJZWxzZToKCQl1cmxsaWIgPSBfX2ltcG9ydF9fKCd1cmxsaWIucmVxdWVzdCcsIGZyb21saXN0PXVybGxpYl9pbXBvcnRzKQpleGNlcHQgSW1wb3J0RXJyb3I6CgloYXNfdXJsbGliID0gRmFsc2UKZWxzZToKCWhhc191cmxsaWIgPSBUcnVlCgppZiBzeXMudmVyc2lvbl9pbmZvWzBdIDwgMzoKCWlzX3N0ciA9IGxhbWJkYSBvYmo6IGlzc3ViY2xhc3Mob2JqLl9fY2xhc3NfXywgc3RyKQoJaXNfYnl0ZXMgPSBsYW1iZGEgb2JqOiBpc3N1YmNsYXNzKG9iai5fX2NsYXNzX18sIHN0cikKCWJ5dGVzID0gbGFtYmRhICphcmdzOiBzdHIoKmFyZ3NbOjFdKQoJTlVMTF9CWVRFID0gJ1x4MDAnCgl1bmljb2RlID0gbGFtYmRhIHg6ICh4LmRlY29kZSgnVVRGLTgnKSBpZiBpc2luc3RhbmNlKHgsIHN0cikgZWxzZSB4KQplbHNlOgoJaWYgaXNpbnN0YW5jZShfX2J1aWx0aW5zX18sIGRpY3QpOgoJCWlzX3N0ciA9IGxhbWJkYSBvYmo6IGlzc3ViY2xhc3Mob2JqLl9fY2xhc3NfXywgX19idWlsdGluc19fWydzdHInXSkKCQlzdHIgPSBsYW1iZGEgeDogX19idWlsdGluc19fWydzdHInXSh4LCAqKCgpIGlmIGlzaW5zdGFuY2UoeCwgKGZsb2F0LCBpbnQpKSBlbHNlICgnVVRGLTgnLCkpKQoJZWxzZToKCQlpc19zdHIgPSBsYW1iZGEgb2JqOiBpc3N1YmNsYXNzKG9iai5fX2NsYXNzX18sIF9fYnVpbHRpbnNfXy5zdHIpCgkJc3RyID0gbGFtYmRhIHg6IF9fYnVpbHRpbnNfXy5zdHIoeCwgKigoKSBpZiBpc2luc3RhbmNlKHgsIChmbG9hdCwgaW50KSkgZWxzZSAoJ1VURi04JywpKSkKCWlzX2J5dGVzID0gbGFtYmRhIG9iajogaXNzdWJjbGFzcyhvYmouX19jbGFzc19fLCBieXRlcykKCU5VTExfQllURSA9IGJ5dGVzKCdceDAwJywgJ1VURi04JykKCWxvbmcgPSBpbnQKCXVuaWNvZGUgPSBsYW1iZGEgeDogKHguZGVjb2RlKCdVVEYtOCcpIGlmIGlzaW5zdGFuY2UoeCwgYnl0ZXMpIGVsc2UgeCkKCiMgcmVzZWVkIHRoZSByYW5kb20gZ2VuZXJhdG9yLgpyYW5kb20uc2VlZCgpCgojCiMgQ29uc3RhbnRzCiMKCiMgdGhlc2UgdmFsdWVzIHdpbGwgYmUgcGF0Y2hlZCwgRE8gTk9UIENIQU5HRSBUSEVNCkRFQlVHR0lORyA9IFRydWUKSFRUUF9DT05ORUNUSU9OX1VSTCA9ICdodHRwczovLzU0LjE4My4xNjYuNzE6NDQzLy1pM2MzJwpIVFRQX1BST1hZID0gTm9uZQpIVFRQX1VTRVJfQUdFTlQgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbycKUEFZTE9BRF9VVUlEID0gJzYyNzQ5Yzc0ZGZlYjY0ZGUzY2Y0MjllMDY1NzY3MWFkJwpTRVNTSU9OX0NPTU1VTklDQVRJT05fVElNRU9VVCA9IDMwMApTRVNTSU9OX0VYUElSQVRJT05fVElNRU9VVCA9IDYwNDgwMApTRVNTSU9OX1JFVFJZX1RPVEFMID0gMzYwMApTRVNTSU9OX1JFVFJZX1dBSVQgPSAxMAoKUEFDS0VUX1RZUEVfUkVRVUVTVCAgICAgICAgPSAwClBBQ0tFVF9UWVBFX1JFU1BPTlNFICAgICAgID0gMQpQQUNLRVRfVFlQRV9QTEFJTl9SRVFVRVNUICA9IDEwClBBQ0tFVF9UWVBFX1BMQUlOX1JFU1BPTlNFID0gMTEKCkVSUk9SX1NVQ0NFU1MgPSAwCiMgbm90IGRlZmluZWQgaW4gb3JpZ2luYWwgQyBpbXBsZW1lbnRhdGlvbgpFUlJPUl9GQUlMVVJFID0gMQpFUlJPUl9GQUlMVVJFX1BZVEhPTiA9IDIKRVJST1JfRkFJTFVSRV9XSU5ET1dTID0gMwoKQ0hBTk5FTF9DTEFTU19CVUZGRVJFRCA9IDAKQ0hBTk5FTF9DTEFTU19TVFJFQU0gICA9IDEKQ0hBTk5FTF9DTEFTU19EQVRBR1JBTSA9IDIKQ0hBTk5FTF9DTEFTU19QT09MICAgICA9IDMKCiMKIyBUTFYgTWV0YSBUeXBlcwojClRMVl9NRVRBX1RZUEVfTk9ORSAgICAgICA9ICggICAwICAgKQpUTFZfTUVUQV9UWVBFX1NUUklORyAgICAgPSAoMSA8PCAxNikKVExWX01FVEFfVFlQRV9VSU5UICAgICAgID0gKDEgPDwgMTcpClRMVl9NRVRBX1RZUEVfUkFXICAgICAgICA9ICgxIDw8IDE4KQpUTFZfTUVUQV9UWVBFX0JPT0wgICAgICAgPSAoMSA8PCAxOSkKVExWX01FVEFfVFlQRV9RV09SRCAgICAgID0gKDEgPDwgMjApClRMVl9NRVRBX1RZUEVfQ09NUFJFU1NFRCA9ICgxIDw8IDI5KQpUTFZfTUVUQV9UWVBFX0dST1VQICAgICAgPSAoMSA8PCAzMCkKVExWX01FVEFfVFlQRV9DT01QTEVYICAgID0gKDEgPDwgMzEpCiMgbm90IGRlZmluZWQgaW4gb3JpZ2luYWwKVExWX01FVEFfVFlQRV9NQVNLID0gKDE8PDMxKSsoMTw8MzApKygxPDwyOSkrKDE8PDE5KSsoMTw8MTgpKygxPDwxNykrKDE8PDE2KQoKIwojIFRMViBiYXNlIHN0YXJ0aW5nIHBvaW50cwojClRMVl9SRVNFUlZFRCAgID0gMApUTFZfRVhURU5TSU9OUyA9IDIwMDAwClRMVl9VU0VSICAgICAgID0gNDAwMDAKVExWX1RFTVAgICAgICAgPSA2MDAwMAoKIwojIFRMViBTcGVjaWZpYyBUeXBlcwojClRMVl9UWVBFX0FOWSAgICAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfTk9ORSAgICB8IDAKVExWX1RZUEVfTUVUSE9EICAgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgMQpUTFZfVFlQRV9SRVFVRVNUX0lEICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCAyClRMVl9UWVBFX0VYQ0VQVElPTiAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfR1JPVVAgICB8IDMKVExWX1RZUEVfUkVTVUxUICAgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNAoKVExWX1RZUEVfU1RSSU5HICAgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgMTAKVExWX1RZUEVfVUlOVCAgICAgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgMTEKVExWX1RZUEVfQk9PTCAgICAgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9CT09MICAgIHwgMTIKClRMVl9UWVBFX0xFTkdUSCAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDI1ClRMVl9UWVBFX0RBVEEgICAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfUkFXICAgICB8IDI2ClRMVl9UWVBFX0ZMQUdTICAgICAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDI3CgpUTFZfVFlQRV9DSEFOTkVMX0lEICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA1MApUTFZfVFlQRV9DSEFOTkVMX1RZUEUgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA1MQpUTFZfVFlQRV9DSEFOTkVMX0RBVEEgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1JBVyAgICAgfCA1MgpUTFZfVFlQRV9DSEFOTkVMX0RBVEFfR1JPVVAgICAgPSBUTFZfTUVUQV9UWVBFX0dST1VQICAgfCA1MwpUTFZfVFlQRV9DSEFOTkVMX0NMQVNTICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA1NApUTFZfVFlQRV9DSEFOTkVMX1BBUkVOVElEICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA1NQoKVExWX1RZUEVfU0VFS19XSEVOQ0UgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNzAKVExWX1RZUEVfU0VFS19PRkZTRVQgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNzEKVExWX1RZUEVfU0VFS19QT1MgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9VSU5UICAgIHwgNzIKClRMVl9UWVBFX0VYQ0VQVElPTl9DT0RFICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDMwMApUTFZfVFlQRV9FWENFUFRJT05fU1RSSU5HICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCAzMDEKClRMVl9UWVBFX0xJQlJBUllfUEFUSCAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfU1RSSU5HICB8IDQwMApUTFZfVFlQRV9UQVJHRVRfUEFUSCAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA0MDEKClRMVl9UWVBFX1RSQU5TX1RZUEUgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDQzMApUTFZfVFlQRV9UUkFOU19VUkwgICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA0MzEKVExWX1RZUEVfVFJBTlNfVUEgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNDMyClRMVl9UWVBFX1RSQU5TX0NPTU1fVElNRU9VVCAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDQzMwpUTFZfVFlQRV9UUkFOU19TRVNTSU9OX0VYUCAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA0MzQKVExWX1RZUEVfVFJBTlNfQ0VSVF9IQVNIICAgICAgID0gVExWX01FVEFfVFlQRV9SQVcgICAgIHwgNDM1ClRMVl9UWVBFX1RSQU5TX1BST1hZX0hPU1QgICAgICA9IFRMVl9NRVRBX1RZUEVfU1RSSU5HICB8IDQzNgpUTFZfVFlQRV9UUkFOU19QUk9YWV9VU0VSICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA0MzcKVExWX1RZUEVfVFJBTlNfUFJPWFlfUEFTUyAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgNDM4ClRMVl9UWVBFX1RSQU5TX1JFVFJZX1RPVEFMICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDQzOQpUTFZfVFlQRV9UUkFOU19SRVRSWV9XQUlUICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCA0NDAKVExWX1RZUEVfVFJBTlNfR1JPVVAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9HUk9VUCAgIHwgNDQxCgpUTFZfVFlQRV9NQUNISU5FX0lEICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA0NjAKVExWX1RZUEVfVVVJRCAgICAgICAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9SQVcgICAgIHwgNDYxCgpUTFZfVFlQRV9DSVBIRVJfTkFNRSAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCA1MDAKVExWX1RZUEVfQ0lQSEVSX1BBUkFNRVRFUlMgICAgID0gVExWX01FVEFfVFlQRV9HUk9VUCAgIHwgNTAxCgpUTFZfVFlQRV9QRUVSX0hPU1QgICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1NUUklORyAgfCAxNTAwClRMVl9UWVBFX1BFRVJfUE9SVCAgICAgICAgICAgICA9IFRMVl9NRVRBX1RZUEVfVUlOVCAgICB8IDE1MDEKVExWX1RZUEVfTE9DQUxfSE9TVCAgICAgICAgICAgID0gVExWX01FVEFfVFlQRV9TVFJJTkcgIHwgMTUwMgpUTFZfVFlQRV9MT0NBTF9QT1JUICAgICAgICAgICAgPSBUTFZfTUVUQV9UWVBFX1VJTlQgICAgfCAxNTAzCgpFWFBPUlRFRF9TWU1CT0xTID0ge30KRVhQT1JURURfU1lNQk9MU1snREVCVUdHSU5HJ10gPSBERUJVR0dJTkcKCmNsYXNzIFNZU1RFTV9JTkZPKGN0eXBlcy5TdHJ1Y3R1cmUpOgoJX2ZpZWxkc18gPSBbKCJ3UHJvY2Vzc29yQXJjaGl0ZWN0dXJlIiwgY3R5cGVzLmNfdWludDE2KSwKCQkoIndSZXNlcnZlZCIsIGN0eXBlcy5jX3VpbnQxNiksCgkJKCJkd1BhZ2VTaXplIiwgY3R5cGVzLmNfdWludDMyKSwKCQkoImxwTWluaW11bUFwcGxpY2F0aW9uQWRkcmVzcyIsIGN0eXBlcy5jX3ZvaWRfcCksCgkJKCJscE1heGltdW1BcHBsaWNhdGlvbkFkZHJlc3MiLCBjdHlwZXMuY192b2lkX3ApLAoJCSgiZHdBY3RpdmVQcm9jZXNzb3JNYXNrIiwgY3R5cGVzLmNfdWludDMyKSwKCQkoImR3TnVtYmVyT2ZQcm9jZXNzb3JzIiwgY3R5cGVzLmNfdWludDMyKSwKCQkoImR3UHJvY2Vzc29yVHlwZSIsIGN0eXBlcy5jX3VpbnQzMiksCgkJKCJkd0FsbG9jYXRpb25HcmFudWxhcml0eSIsIGN0eXBlcy5jX3VpbnQzMiksCgkJKCJ3UHJvY2Vzc29yTGV2ZWwiLCBjdHlwZXMuY191aW50MTYpLAoJCSgid1Byb2Nlc3NvclJldmlzaW9uIiwgY3R5cGVzLmNfdWludDE2KV0KCmRlZiByYW5kX3hvcl9rZXkoKToKCXJldHVybiB0dXBsZShyYW5kb20ucmFuZGludCgxLCAyNTUpIGZvciBfIGluIHJhbmdlKDQpKQoKZGVmIHhvcl9ieXRlcyhrZXksIGRhdGEpOgoJaWYgc3lzLnZlcnNpb25faW5mb1swXSA8IDM6CgkJZGV4b3JlZCA9ICcnLmpvaW4oY2hyKG9yZChkYXRhW2ldKSBeIGtleVtpICUgbGVuKGtleSldKSBmb3IgaSBpbiByYW5nZShsZW4oZGF0YSkpKQoJZWxzZToKCQlkZXhvcmVkID0gYnl0ZXMoZGF0YVtpXSBeIGtleVtpICUgbGVuKGtleSldIGZvciBpIGluIHJhbmdlKGxlbihkYXRhKSkpCglyZXR1cm4gZGV4b3JlZAoKZGVmIGV4cG9ydChzeW1ib2wpOgoJRVhQT1JURURfU1lNQk9MU1tzeW1ib2wuX19uYW1lX19dID0gc3ltYm9sCglyZXR1cm4gc3ltYm9sCgpkZWYgZ2VuZXJhdGVfcmVxdWVzdF9pZCgpOgoJY2hhcnMgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonCglyZXR1cm4gJycuam9pbihyYW5kb20uY2hvaWNlKGNoYXJzKSBmb3IgeCBpbiByYW5nZSgzMikpCgpAZXhwb3J0CmRlZiBjcmMxNihkYXRhKToKCXBvbHkgPSAweDEwMjEKCXJlZyA9IDB4MDAwMAoJaWYgaXNfc3RyKGRhdGEpOgoJCWRhdGEgPSBsaXN0KG1hcChvcmQsIGRhdGEpKQoJZWxpZiBpc19ieXRlcyhkYXRhKToKCQlkYXRhID0gbGlzdChkYXRhKQoJZGF0YS5hcHBlbmQoMCkKCWRhdGEuYXBwZW5kKDApCglmb3IgYnl0ZSBpbiBkYXRhOgoJCW1hc2sgPSAweDgwCgkJd2hpbGUgbWFzayA+IDA6CgkJCXJlZyA8PD0gMQoJCQlpZiBieXRlICYgbWFzazoKCQkJCXJlZyArPSAxCgkJCW1hc2sgPj49IDEKCQkJaWYgcmVnID4gMHhmZmZmOgoJCQkJcmVnICY9IDB4ZmZmZgoJCQkJcmVnIF49IHBvbHkKCXJldHVybiByZWcKCkBleHBvcnQKZGVmIGRlYnVnX3ByaW50KG1zZyk6CglpZiBERUJVR0dJTkc6CgkJcHJpbnQobXNnKQoKQGV4cG9ydApkZWYgZXJyb3JfcmVzdWx0KGV4Y2VwdGlvbj1Ob25lKToKCWlmIG5vdCBleGNlcHRpb246CgkJXywgZXhjZXB0aW9uLCBfID0gc3lzLmV4Y19pbmZvKCkKCWV4Y2VwdGlvbl9jcmMgPSBjcmMxNihleGNlcHRpb24uX19jbGFzc19fLl9fbmFtZV9fKQoJaWYgZXhjZXB0aW9uX2NyYyA9PSAweDRjYjI6ICMgV2luZG93c0Vycm9yCgkJcmV0dXJuIGVycm9yX3Jlc3VsdF93aW5kb3dzKGV4Y2VwdGlvbi5lcnJubykKCWVsc2U6CgkJcmVzdWx0ID0gKChleGNlcHRpb25fY3JjIDw8IDE2KSB8IEVSUk9SX0ZBSUxVUkVfUFlUSE9OKQoJcmV0dXJuIHJlc3VsdAoKQGV4cG9ydApkZWYgZXJyb3JfcmVzdWx0X3dpbmRvd3MoZXJyb3JfbnVtYmVyPU5vbmUpOgoJaWYgbm90IGhhc193aW5kbGw6CgkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUKCWlmIGVycm9yX251bWJlciA9PSBOb25lOgoJCWVycm9yX251bWJlciA9IGN0eXBlcy53aW5kbGwua2VybmVsMzIuR2V0TGFzdEVycm9yKCkKCWlmIGVycm9yX251bWJlciA+IDB4ZmZmZjoKCQlyZXR1cm4gRVJST1JfRkFJTFVSRQoJcmVzdWx0ID0gKChlcnJvcl9udW1iZXIgPDwgMTYpIHwgRVJST1JfRkFJTFVSRV9XSU5ET1dTKQoJcmV0dXJuIHJlc3VsdAoKQGV4cG9ydApkZWYgZ2V0X2hkZF9sYWJlbCgpOgoJZm9yIF8sIF8sIGZpbGVzIGluIG9zLndhbGsoJy9kZXYvZGlzay9ieS1pZC8nKToKCQlmb3IgZiBpbiBmaWxlczoKCQkJZm9yIHAgaW4gWydhdGEtJywgJ21iLSddOgoJCQkJaWYgZls6bGVuKHApXSA9PSBwOgoJCQkJCXJldHVybiBmW2xlbihwKTpdCglyZXR1cm4gJycKCkBleHBvcnQKZGVmIGdldF9uYXRpdmVfYXJjaCgpOgoJYXJjaCA9IGdldF9zeXN0ZW1fYXJjaCgpCglpZiBhcmNoID09ICd4NjQnIGFuZCBjdHlwZXMuc2l6ZW9mKGN0eXBlcy5jX3ZvaWRfcCkgPT0gNDoKCQlhcmNoID0gJ3g4NicKCXJldHVybiBhcmNoCgpAZXhwb3J0CmRlZiBnZXRfc3lzdGVtX2FyY2goKToKCXVuYW1lX2luZm8gPSBwbGF0Zm9ybS51bmFtZSgpCglhcmNoID0gdW5hbWVfaW5mb1s0XQoJaWYgaGFzX3dpbmRsbDoKCQlzeXNpbmZvID0gU1lTVEVNX0lORk8oKQoJCWN0eXBlcy53aW5kbGwua2VybmVsMzIuR2V0TmF0aXZlU3lzdGVtSW5mbyhjdHlwZXMuYnlyZWYoc3lzaW5mbykpCgkJdmFsdWVzID0gezA6J3g4NicsIDU6J2FybWxlJywgNjonSUE2NCcsIDk6J3g2NCd9CgkJYXJjaCA9IHZhbHVlcy5nZXQoc3lzaW5mby53UHJvY2Vzc29yQXJjaGl0ZWN0dXJlLCB1bmFtZV9pbmZvWzRdKQoJaWYgYXJjaCA9PSAneDg2XzY0JzoKCQlhcmNoID0gJ3g2NCcKCXJldHVybiBhcmNoCgpAZXhwb3J0CmRlZiBpbmV0X3B0b24oZmFtaWx5LCBhZGRyZXNzKToKCWlmIGhhc2F0dHIoc29ja2V0LCAnaW5ldF9wdG9uJyk6CgkJcmV0dXJuIHNvY2tldC5pbmV0X3B0b24oZmFtaWx5LCBhZGRyZXNzKQoJZWxpZiBoYXNfd2luZGxsOgoJCVdTQVN0cmluZ1RvQWRkcmVzcyA9IGN0eXBlcy53aW5kbGwud3MyXzMyLldTQVN0cmluZ1RvQWRkcmVzc0EKCQlscEFkZHJlc3MgPSAoY3R5cGVzLmNfdWJ5dGUgKiAyOCkoKQoJCWxwQWRkcmVzc0xlbmd0aCA9IGN0eXBlcy5jX2ludChjdHlwZXMuc2l6ZW9mKGxwQWRkcmVzcykpCgkJaWYgV1NBU3RyaW5nVG9BZGRyZXNzKGFkZHJlc3MsIGZhbWlseSwgTm9uZSwgY3R5cGVzLmJ5cmVmKGxwQWRkcmVzcyksIGN0eXBlcy5ieXJlZihscEFkZHJlc3NMZW5ndGgpKSAhPSAwOgoJCQlyYWlzZSBFeGNlcHRpb24oJ1dTQVN0cmluZ1RvQWRkcmVzcyBmYWlsZWQnKQoJCWlmIGZhbWlseSA9PSBzb2NrZXQuQUZfSU5FVDoKCQkJcmV0dXJuICcnLmpvaW4obWFwKGNociwgbHBBZGRyZXNzWzQ6OF0pKQoJCWVsaWYgZmFtaWx5ID09IHNvY2tldC5BRl9JTkVUNjoKCQkJcmV0dXJuICcnLmpvaW4obWFwKGNociwgbHBBZGRyZXNzWzg6MjRdKSkKCXJhaXNlIEV4Y2VwdGlvbignbm8gc3VpdGFibGUgaW5ldF9wdG9uIGZ1bmN0aW9uYWxpdHkgaXMgYXZhaWxhYmxlJykKCkBleHBvcnQKZGVmIHBhY2tldF9lbnVtX3RsdnMocGt0LCB0bHZfdHlwZT1Ob25lKToKCW9mZnNldCA9IDAKCXdoaWxlIG9mZnNldCA8IGxlbihwa3QpOgoJCXRsdiA9IHN0cnVjdC51bnBhY2soJz5JSScsIHBrdFtvZmZzZXQ6b2Zmc2V0ICsgOF0pCgkJaWYgdGx2X3R5cGUgaXMgTm9uZSBvciAodGx2WzFdICYgflRMVl9NRVRBX1RZUEVfQ09NUFJFU1NFRCkgPT0gdGx2X3R5cGU6CgkJCXZhbCA9IHBrdFtvZmZzZXQgKyA4OihvZmZzZXQgKyA4ICsgKHRsdlswXSAtIDgpKV0KCQkJaWYgKHRsdlsxXSAmIFRMVl9NRVRBX1RZUEVfU1RSSU5HKSA9PSBUTFZfTUVUQV9UWVBFX1NUUklORzoKCQkJCXZhbCA9IHN0cih2YWwuc3BsaXQoTlVMTF9CWVRFLCAxKVswXSkKCQkJZWxpZiAodGx2WzFdICYgVExWX01FVEFfVFlQRV9VSU5UKSA9PSBUTFZfTUVUQV9UWVBFX1VJTlQ6CgkJCQl2YWwgPSBzdHJ1Y3QudW5wYWNrKCc+SScsIHZhbClbMF0KCQkJZWxpZiAodGx2WzFdICYgVExWX01FVEFfVFlQRV9RV09SRCkgPT0gVExWX01FVEFfVFlQRV9RV09SRDoKCQkJCXZhbCA9IHN0cnVjdC51bnBhY2soJz5RJywgdmFsKVswXQoJCQllbGlmICh0bHZbMV0gJiBUTFZfTUVUQV9UWVBFX0JPT0wpID09IFRMVl9NRVRBX1RZUEVfQk9PTDoKCQkJCXZhbCA9IGJvb2woc3RydWN0LnVucGFjaygnYicsIHZhbClbMF0pCgkJCWVsaWYgKHRsdlsxXSAmIFRMVl9NRVRBX1RZUEVfUkFXKSA9PSBUTFZfTUVUQV9UWVBFX1JBVzoKCQkJCXBhc3MKCQkJeWllbGQgeyd0eXBlJzogdGx2WzFdLCAnbGVuZ3RoJzogdGx2WzBdLCAndmFsdWUnOiB2YWx9CgkJb2Zmc2V0ICs9IHRsdlswXQoJcmFpc2UgU3RvcEl0ZXJhdGlvbigpCgpAZXhwb3J0CmRlZiBwYWNrZXRfZ2V0X3Rsdihwa3QsIHRsdl90eXBlKToKCXRyeToKCQl0bHYgPSBsaXN0KHBhY2tldF9lbnVtX3RsdnMocGt0LCB0bHZfdHlwZSkpWzBdCglleGNlcHQgSW5kZXhFcnJvcjoKCQlyZXR1cm4ge30KCXJldHVybiB0bHYKCkBleHBvcnQKZGVmIHRsdl9wYWNrKCphcmdzKToKCWlmIGxlbihhcmdzKSA9PSAyOgoJCXRsdiA9IHsndHlwZSc6YXJnc1swXSwgJ3ZhbHVlJzphcmdzWzFdfQoJZWxzZToKCQl0bHYgPSBhcmdzWzBdCglkYXRhID0gJycKCXZhbHVlID0gdGx2Wyd2YWx1ZSddCglpZiAodGx2Wyd0eXBlJ10gJiBUTFZfTUVUQV9UWVBFX1VJTlQpID09IFRMVl9NRVRBX1RZUEVfVUlOVDoKCQlpZiBpc2luc3RhbmNlKHZhbHVlLCBmbG9hdCk6CgkJCXZhbHVlID0gaW50KHJvdW5kKHZhbHVlKSkKCQlkYXRhID0gc3RydWN0LnBhY2soJz5JSUknLCAxMiwgdGx2Wyd0eXBlJ10sIHZhbHVlKQoJZWxpZiAodGx2Wyd0eXBlJ10gJiBUTFZfTUVUQV9UWVBFX1FXT1JEKSA9PSBUTFZfTUVUQV9UWVBFX1FXT1JEOgoJCWRhdGEgPSBzdHJ1Y3QucGFjaygnPklJUScsIDE2LCB0bHZbJ3R5cGUnXSwgdmFsdWUpCgllbGlmICh0bHZbJ3R5cGUnXSAmIFRMVl9NRVRBX1RZUEVfQk9PTCkgPT0gVExWX01FVEFfVFlQRV9CT09MOgoJCWRhdGEgPSBzdHJ1Y3QucGFjaygnPklJJywgOSwgdGx2Wyd0eXBlJ10pICsgYnl0ZXMoY2hyKGludChib29sKHZhbHVlKSkpLCAnVVRGLTgnKQoJZWxzZToKCQlpZiBzeXMudmVyc2lvbl9pbmZvWzBdIDwgMyBhbmQgdmFsdWUuX19jbGFzc19fLl9fbmFtZV9fID09ICd1bmljb2RlJzoKCQkJdmFsdWUgPSB2YWx1ZS5lbmNvZGUoJ1VURi04JykKCQllbGlmIG5vdCBpc19ieXRlcyh2YWx1ZSk6CgkJCXZhbHVlID0gYnl0ZXModmFsdWUsICdVVEYtOCcpCgkJaWYgKHRsdlsndHlwZSddICYgVExWX01FVEFfVFlQRV9TVFJJTkcpID09IFRMVl9NRVRBX1RZUEVfU1RSSU5HOgoJCQlkYXRhID0gc3RydWN0LnBhY2soJz5JSScsIDggKyBsZW4odmFsdWUpICsgMSwgdGx2Wyd0eXBlJ10pICsgdmFsdWUgKyBOVUxMX0JZVEUKCQllbGlmICh0bHZbJ3R5cGUnXSAmIFRMVl9NRVRBX1RZUEVfUkFXKSA9PSBUTFZfTUVUQV9UWVBFX1JBVzoKCQkJZGF0YSA9IHN0cnVjdC5wYWNrKCc+SUknLCA4ICsgbGVuKHZhbHVlKSwgdGx2Wyd0eXBlJ10pICsgdmFsdWUKCQllbGlmICh0bHZbJ3R5cGUnXSAmIFRMVl9NRVRBX1RZUEVfR1JPVVApID09IFRMVl9NRVRBX1RZUEVfR1JPVVA6CgkJCWRhdGEgPSBzdHJ1Y3QucGFjaygnPklJJywgOCArIGxlbih2YWx1ZSksIHRsdlsndHlwZSddKSArIHZhbHVlCgkJZWxpZiAodGx2Wyd0eXBlJ10gJiBUTFZfTUVUQV9UWVBFX0NPTVBMRVgpID09IFRMVl9NRVRBX1RZUEVfQ09NUExFWDoKCQkJZGF0YSA9IHN0cnVjdC5wYWNrKCc+SUknLCA4ICsgbGVuKHZhbHVlKSwgdGx2Wyd0eXBlJ10pICsgdmFsdWUKCXJldHVybiBkYXRhCgpAZXhwb3J0CmRlZiB0bHZfcGFja19yZXNwb25zZShyZXN1bHQsIHJlc3BvbnNlKToKCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX1JFU1VMVCwgcmVzdWx0KQoJcmVzcG9uc2UgPSBzdHJ1Y3QucGFjaygnPkknLCBsZW4ocmVzcG9uc2UpICsgNCkgKyByZXNwb25zZQoJcmV0dXJuIHJlc3BvbnNlCgojQGV4cG9ydApjbGFzcyBNZXRlcnByZXRlckZpbGUob2JqZWN0KToKCWRlZiBfX2luaXRfXyhzZWxmLCBmaWxlX29iaik6CgkJc2VsZi5maWxlX29iaiA9IGZpbGVfb2JqCgoJZGVmIF9fZ2V0YXR0cl9fKHNlbGYsIG5hbWUpOgoJCXJldHVybiBnZXRhdHRyKHNlbGYuZmlsZV9vYmosIG5hbWUpCmV4cG9ydChNZXRlcnByZXRlckZpbGUpCgojQGV4cG9ydApjbGFzcyBNZXRlcnByZXRlclNvY2tldChvYmplY3QpOgoJZGVmIF9faW5pdF9fKHNlbGYsIHNvY2spOgoJCXNlbGYuc29jayA9IHNvY2sKCglkZWYgX19nZXRhdHRyX18oc2VsZiwgbmFtZSk6CgkJcmV0dXJuIGdldGF0dHIoc2VsZi5zb2NrLCBuYW1lKQpleHBvcnQoTWV0ZXJwcmV0ZXJTb2NrZXQpCgojQGV4cG9ydApjbGFzcyBNZXRlcnByZXRlclNvY2tldENsaWVudChNZXRlcnByZXRlclNvY2tldCk6CglwYXNzCmV4cG9ydChNZXRlcnByZXRlclNvY2tldENsaWVudCkKCiNAZXhwb3J0CmNsYXNzIE1ldGVycHJldGVyU29ja2V0U2VydmVyKE1ldGVycHJldGVyU29ja2V0KToKCXBhc3MKZXhwb3J0KE1ldGVycHJldGVyU29ja2V0U2VydmVyKQoKY2xhc3MgU1REUHJvY2Vzc0J1ZmZlcih0aHJlYWRpbmcuVGhyZWFkKToKCWRlZiBfX2luaXRfXyhzZWxmLCBzdGQsIGlzX2FsaXZlKToKCQl0aHJlYWRpbmcuVGhyZWFkLl9faW5pdF9fKHNlbGYpCgkJc2VsZi5zdGQgPSBzdGQKCQlzZWxmLmlzX2FsaXZlID0gaXNfYWxpdmUKCQlzZWxmLmRhdGEgPSBieXRlcygpCgkJc2VsZi5kYXRhX2xvY2sgPSB0aHJlYWRpbmcuUkxvY2soKQoKCWRlZiBydW4oc2VsZik6CgkJZm9yIGJ5dGUgaW4gaXRlcihsYW1iZGE6IHNlbGYuc3RkLnJlYWQoMSksIGJ5dGVzKCkpOgoJCQlzZWxmLmRhdGFfbG9jay5hY3F1aXJlKCkKCQkJc2VsZi5kYXRhICs9IGJ5dGUKCQkJc2VsZi5kYXRhX2xvY2sucmVsZWFzZSgpCgoJZGVmIGlzX3JlYWRfcmVhZHkoc2VsZik6CgkJcmV0dXJuIGxlbihzZWxmLmRhdGEpICE9IDAKCglkZWYgcGVlayhzZWxmLCBsID0gTm9uZSk6CgkJZGF0YSA9IGJ5dGVzKCkKCQlzZWxmLmRhdGFfbG9jay5hY3F1aXJlKCkKCQlpZiBsID09IE5vbmU6CgkJCWRhdGEgPSBzZWxmLmRhdGEKCQllbHNlOgoJCQlkYXRhID0gc2VsZi5kYXRhWzA6bF0KCQlzZWxmLmRhdGFfbG9jay5yZWxlYXNlKCkKCQlyZXR1cm4gZGF0YQoKCWRlZiByZWFkKHNlbGYsIGwgPSBOb25lKToKCQlzZWxmLmRhdGFfbG9jay5hY3F1aXJlKCkKCQlkYXRhID0gc2VsZi5wZWVrKGwpCgkJc2VsZi5kYXRhID0gc2VsZi5kYXRhW2xlbihkYXRhKTpdCgkJc2VsZi5kYXRhX2xvY2sucmVsZWFzZSgpCgkJcmV0dXJuIGRhdGEKCiNAZXhwb3J0CmNsYXNzIFNURFByb2Nlc3Moc3VicHJvY2Vzcy5Qb3Blbik6CglkZWYgX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKToKCQlkZWJ1Z19wcmludCgnWypdIHN0YXJ0aW5nIHByb2Nlc3M6ICcgKyByZXByKGFyZ3NbMF0pKQoJCXN1YnByb2Nlc3MuUG9wZW4uX19pbml0X18oc2VsZiwgKmFyZ3MsICoqa3dhcmdzKQoJCXNlbGYuZWNob19wcm90ZWN0aW9uID0gRmFsc2UKCglkZWYgc3RhcnQoc2VsZik6CgkJc2VsZi5zdGRvdXRfcmVhZGVyID0gU1REUHJvY2Vzc0J1ZmZlcihzZWxmLnN0ZG91dCwgbGFtYmRhOiBzZWxmLnBvbGwoKSA9PSBOb25lKQoJCXNlbGYuc3Rkb3V0X3JlYWRlci5zdGFydCgpCgkJc2VsZi5zdGRlcnJfcmVhZGVyID0gU1REUHJvY2Vzc0J1ZmZlcihzZWxmLnN0ZGVyciwgbGFtYmRhOiBzZWxmLnBvbGwoKSA9PSBOb25lKQoJCXNlbGYuc3RkZXJyX3JlYWRlci5zdGFydCgpCgoJZGVmIHdyaXRlKHNlbGYsIGNoYW5uZWxfZGF0YSk6CgkJc2VsZi5zdGRpbi53cml0ZShjaGFubmVsX2RhdGEpCgkJc2VsZi5zdGRpbi5mbHVzaCgpCgkJaWYgc2VsZi5lY2hvX3Byb3RlY3Rpb246CgkJCWVuZF90aW1lID0gdGltZS50aW1lKCkgKyAwLjUKCQkJb3V0X2RhdGEgPSBieXRlcygpCgkJCXdoaWxlICh0aW1lLnRpbWUoKSA8IGVuZF90aW1lKSBhbmQgKG91dF9kYXRhICE9IGNoYW5uZWxfZGF0YSk6CgkJCQlpZiBzZWxmLnN0ZG91dF9yZWFkZXIuaXNfcmVhZF9yZWFkeSgpOgoJCQkJCW91dF9kYXRhID0gc2VsZi5zdGRvdXRfcmVhZGVyLnBlZWsobGVuKGNoYW5uZWxfZGF0YSkpCgkJCWlmIG91dF9kYXRhID09IGNoYW5uZWxfZGF0YToKCQkJCXNlbGYuc3Rkb3V0X3JlYWRlci5yZWFkKGxlbihjaGFubmVsX2RhdGEpKQpleHBvcnQoU1REUHJvY2VzcykKCmNsYXNzIFRyYW5zcG9ydChvYmplY3QpOgoJZGVmIF9faW5pdF9fKHNlbGYpOgoJCXNlbGYuY29tbXVuaWNhdGlvbl90aW1lb3V0ID0gU0VTU0lPTl9DT01NVU5JQ0FUSU9OX1RJTUVPVVQKCQlzZWxmLmNvbW11bmljYXRpb25fbGFzdCA9IDAKCQlzZWxmLnJldHJ5X3RvdGFsID0gU0VTU0lPTl9SRVRSWV9UT1RBTAoJCXNlbGYucmV0cnlfd2FpdCA9IFNFU1NJT05fUkVUUllfV0FJVAoJCXNlbGYucmVxdWVzdF9yZXRpcmUgPSBGYWxzZQoKCWRlZiBfX3JlcHJfXyhzZWxmKToKCQlyZXR1cm4gIjx7MH0gdXJsPSd7MX0nID4iLmZvcm1hdChzZWxmLl9fY2xhc3NfXy5fX25hbWVfXywgc2VsZi51cmwpCgoJQHByb3BlcnR5CglkZWYgY29tbXVuaWNhdGlvbl9oYXNfZXhwaXJlZChzZWxmKToKCQlyZXR1cm4gc2VsZi5jb21tdW5pY2F0aW9uX2xhc3QgKyBzZWxmLmNvbW11bmljYXRpb25fdGltZW91dCA8IHRpbWUudGltZSgpCgoJQHByb3BlcnR5CglkZWYgc2hvdWxkX3JldGlyZShzZWxmKToKCQlyZXR1cm4gc2VsZi5jb21tdW5pY2F0aW9uX2hhc19leHBpcmVkIG9yIHNlbGYucmVxdWVzdF9yZXRpcmUKCglAc3RhdGljbWV0aG9kCglkZWYgZnJvbV9yZXF1ZXN0KHJlcXVlc3QpOgoJCXVybCA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX1VSTClbJ3ZhbHVlJ10KCQlpZiB1cmwuc3RhcnRzd2l0aCgndGNwJyk6CgkJCXRyYW5zcG9ydCA9IFRjcFRyYW5zcG9ydCh1cmwpCgkJZWxpZiB1cmwuc3RhcnRzd2l0aCgnaHR0cCcpOgoJCQlwcm94eSA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX1BST1hZX0hPU1QpLmdldCgndmFsdWUnKQoJCQl1c2VyX2FnZW50ID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfVUEpLmdldCgndmFsdWUnLCBIVFRQX1VTRVJfQUdFTlQpCgkJCXRyYW5zcG9ydCA9IEh0dHBUcmFuc3BvcnQodXJsLCBwcm94eT1wcm94eSwgdXNlcl9hZ2VudD11c2VyX2FnZW50KQoJCXRyYW5zcG9ydC5jb21tdW5pY2F0aW9uX3RpbWVvdXQgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19DT01NX1RJTUVPVVQpLmdldCgndmFsdWUnLCBTRVNTSU9OX0NPTU1VTklDQVRJT05fVElNRU9VVCkKCQl0cmFuc3BvcnQucmV0cnlfdG90YWwgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19SRVRSWV9UT1RBTCkuZ2V0KCd2YWx1ZScsIFNFU1NJT05fUkVUUllfVE9UQUwpCgkJdHJhbnNwb3J0LnJldHJ5X3dhaXQgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19SRVRSWV9XQUlUKS5nZXQoJ3ZhbHVlJywgU0VTU0lPTl9SRVRSWV9XQUlUKQoJCXJldHVybiB0cmFuc3BvcnQKCglkZWYgX2FjdGl2YXRlKHNlbGYpOgoJCXJldHVybiBUcnVlCgoJZGVmIGFjdGl2YXRlKHNlbGYpOgoJCWVuZF90aW1lID0gdGltZS50aW1lKCkgKyBzZWxmLnJldHJ5X3RvdGFsCgkJd2hpbGUgdGltZS50aW1lKCkgPCBlbmRfdGltZToKCQkJdHJ5OgoJCQkJYWN0aXZhdGVfc3VjY2VlZGVkID0gc2VsZi5fYWN0aXZhdGUoKQoJCQlleGNlcHQ6CgkJCQlhY3RpdmF0ZV9zdWNjZWVkZWQgPSBGYWxzZQoJCQlpZiBhY3RpdmF0ZV9zdWNjZWVkZWQ6CgkJCQlzZWxmLmNvbW11bmljYXRpb25fbGFzdCA9IHRpbWUudGltZSgpCgkJCQlyZXR1cm4gVHJ1ZQoJCQl0aW1lLnNsZWVwKHNlbGYucmV0cnlfd2FpdCkKCQlyZXR1cm4gRmFsc2UKCglkZWYgX2RlYWN0aXZhdGUoc2VsZik6CgkJcmV0dXJuCgoJZGVmIGRlYWN0aXZhdGUoc2VsZik6CgkJdHJ5OgoJCQlzZWxmLl9kZWFjdGl2YXRlKCkKCQlleGNlcHQ6CgkJCXBhc3MKCQlzZWxmLmNvbW11bmljYXRpb25fbGFzdCA9IDAKCQlyZXR1cm4gVHJ1ZQoKCWRlZiBnZXRfcGFja2V0KHNlbGYpOgoJCXNlbGYucmVxdWVzdF9yZXRpcmUgPSBGYWxzZQoJCXRyeToKCQkJcGt0ID0gc2VsZi5fZ2V0X3BhY2tldCgpCgkJZXhjZXB0OgoJCQlyZXR1cm4gTm9uZQoJCWlmIHBrdCBpcyBOb25lOgoJCQlyZXR1cm4gTm9uZQoJCXNlbGYuY29tbXVuaWNhdGlvbl9sYXN0ID0gdGltZS50aW1lKCkKCQlyZXR1cm4gcGt0CgoJZGVmIHNlbmRfcGFja2V0KHNlbGYsIHBrdCk6CgkJc2VsZi5yZXF1ZXN0X3JldGlyZSA9IEZhbHNlCgkJdHJ5OgoJCQl4b3Jfa2V5ID0gcmFuZF94b3Jfa2V5KCkKCQkJcmF3ID0gc3RydWN0LnBhY2soJ0JCQkInLCAqeG9yX2tleVs6Oi0xXSkgKyB4b3JfYnl0ZXMoeG9yX2tleSwgcGt0KQoJCQlzZWxmLl9zZW5kX3BhY2tldChyYXcpCgkJZXhjZXB0OgoJCQlyZXR1cm4gRmFsc2UKCQlzZWxmLmNvbW11bmljYXRpb25fbGFzdCA9IHRpbWUudGltZSgpCgkJcmV0dXJuIFRydWUKCglkZWYgdGx2X3BhY2tfdGltZW91dHMoc2VsZik6CgkJcmVzcG9uc2UgID0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfQ09NTV9USU1FT1VULCBzZWxmLmNvbW11bmljYXRpb25fdGltZW91dCkKCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9UUkFOU19SRVRSWV9UT1RBTCwgc2VsZi5yZXRyeV90b3RhbCkKCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9UUkFOU19SRVRSWV9XQUlULCBzZWxmLnJldHJ5X3dhaXQpCgkJcmV0dXJuIHJlc3BvbnNlCgoJZGVmIHRsdl9wYWNrX3RyYW5zcG9ydF9ncm91cChzZWxmKToKCQl0cmFuc19ncm91cCAgPSB0bHZfcGFjayhUTFZfVFlQRV9UUkFOU19VUkwsIHNlbGYudXJsKQoJCXRyYW5zX2dyb3VwICs9IHNlbGYudGx2X3BhY2tfdGltZW91dHMoKQoJCXJldHVybiB0cmFuc19ncm91cAoKY2xhc3MgSHR0cFRyYW5zcG9ydChUcmFuc3BvcnQpOgoJZGVmIF9faW5pdF9fKHNlbGYsIHVybCwgcHJveHk9Tm9uZSwgdXNlcl9hZ2VudD1Ob25lKToKCQlzdXBlcihIdHRwVHJhbnNwb3J0LCBzZWxmKS5fX2luaXRfXygpCgkJb3BlbmVyX2FyZ3MgPSBbXQoJCXNjaGVtZSA9IHVybC5zcGxpdCgnOicsIDEpWzBdCgkJaWYgc2NoZW1lID09ICdodHRwcycgYW5kICgoc3lzLnZlcnNpb25faW5mb1swXSA9PSAyIGFuZCBzeXMudmVyc2lvbl9pbmZvID49ICgyLCA3LCA5KSkgb3Igc3lzLnZlcnNpb25faW5mbyA+PSAoMywgNCwgMykpOgoJCQlpbXBvcnQgc3NsCgkJCXNzbF9jdHggPSBzc2wuU1NMQ29udGV4dChzc2wuUFJPVE9DT0xfU1NMdjIzKQoJCQlzc2xfY3R4LmNoZWNrX2hvc3RuYW1lID0gRmFsc2UKCQkJc3NsX2N0eC52ZXJpZnlfbW9kZSA9IHNzbC5DRVJUX05PTkUKCQkJb3BlbmVyX2FyZ3MuYXBwZW5kKHVybGxpYi5IVFRQU0hhbmRsZXIoMCwgc3NsX2N0eCkpCgkJaWYgcHJveHk6CgkJCW9wZW5lcl9hcmdzLmFwcGVuZCh1cmxsaWIuUHJveHlIYW5kbGVyKHtzY2hlbWU6IHByb3h5fSkpCgkJc2VsZi5wcm94eSA9IHByb3h5CgkJb3BlbmVyID0gdXJsbGliLmJ1aWxkX29wZW5lcigqb3BlbmVyX2FyZ3MpCgkJaWYgdXNlcl9hZ2VudDoKCQkJb3BlbmVyLmFkZGhlYWRlcnMgPSBbKCdVc2VyLUFnZW50JywgdXNlcl9hZ2VudCldCgkJc2VsZi51c2VyX2FnZW50ID0gdXNlcl9hZ2VudAoJCXVybGxpYi5pbnN0YWxsX29wZW5lcihvcGVuZXIpCgkJc2VsZi51cmwgPSB1cmwKCQlzZWxmLl9odHRwX3JlcXVlc3RfaGVhZGVycyA9IHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSd9CgkJc2VsZi5fZmlyc3RfcGFja2V0ID0gTm9uZQoJCXNlbGYuX2VtcHR5X2NudCA9IDAKCglkZWYgX2FjdGl2YXRlKHNlbGYpOgoJCXJldHVybiBUcnVlCgkJc2VsZi5fZmlyc3RfcGFja2V0ID0gTm9uZQoJCXBhY2tldCA9IHNlbGYuX2dldF9wYWNrZXQoKQoJCWlmIHBhY2tldCBpcyBOb25lOgoJCQlyZXR1cm4gRmFsc2UKCQlzZWxmLl9maXJzdF9wYWNrZXQgPSBwYWNrZXQKCQlyZXR1cm4gVHJ1ZQoKCWRlZiBfZ2V0X3BhY2tldChzZWxmKToKCQlpZiBzZWxmLl9maXJzdF9wYWNrZXQ6CgkJCXBhY2tldCA9IHNlbGYuX2ZpcnN0X3BhY2tldAoJCQlzZWxmLl9maXJzdF9wYWNrZXQgPSBOb25lCgkJCXJldHVybiBwYWNrZXQKCQlwYWNrZXQgPSBOb25lCgkJeG9yX2tleSA9IE5vbmUKCQlyZXF1ZXN0ID0gdXJsbGliLlJlcXVlc3Qoc2VsZi51cmwsIE5vbmUsIHNlbGYuX2h0dHBfcmVxdWVzdF9oZWFkZXJzKQoJCXVybF9oID0gdXJsbGliLnVybG9wZW4ocmVxdWVzdCwgdGltZW91dD1zZWxmLmNvbW11bmljYXRpb25fdGltZW91dCkKCQlwYWNrZXQgPSB1cmxfaC5yZWFkKCkKCQlmb3IgXyBpbiByYW5nZSgxKToKCQkJaWYgcGFja2V0ID09ICcnOgoJCQkJYnJlYWsKCQkJaWYgbGVuKHBhY2tldCkgPCAxMjoKCQkJCXBhY2tldCA9IE5vbmUgICMgbG9va3MgY29ycnVwdAoJCQkJYnJlYWsKCQkJeG9yX2tleSA9IHN0cnVjdC51bnBhY2soJ0JCQkInLCBwYWNrZXRbOjRdWzo6LTFdKQoJCQloZWFkZXIgPSB4b3JfYnl0ZXMoeG9yX2tleSwgcGFja2V0WzQ6MTJdKQoJCQlwa3RfbGVuZ3RoLCBfID0gc3RydWN0LnVucGFjaygnPklJJywgaGVhZGVyKQoJCQlpZiBsZW4ocGFja2V0KSAtIDQgIT0gcGt0X2xlbmd0aDoKCQkJCXBhY2tldCA9IE5vbmUgICMgbG9va3MgY29ycnVwdAoJCWlmIG5vdCBwYWNrZXQ6CgkJCWRlbGF5ID0gMTAgKiBzZWxmLl9lbXB0eV9jbnQKCQkJaWYgc2VsZi5fZW1wdHlfY250ID49IDA6CgkJCQlkZWxheSAqPSAxMAoJCQlzZWxmLl9lbXB0eV9jbnQgKz0gMQoJCQl0aW1lLnNsZWVwKGZsb2F0KG1pbigxMDAwMCwgZGVsYXkpKSAvIDEwMDApCgkJCXJldHVybiBwYWNrZXQKCQlzZWxmLl9lbXB0eV9jbnQgPSAwCgkJcmV0dXJuIHhvcl9ieXRlcyh4b3Jfa2V5LCBwYWNrZXRbMTI6XSkKCglkZWYgX3NlbmRfcGFja2V0KHNlbGYsIHBhY2tldCk6CgkJcmVxdWVzdCA9IHVybGxpYi5SZXF1ZXN0KHNlbGYudXJsLCBwYWNrZXQsIHNlbGYuX2h0dHBfcmVxdWVzdF9oZWFkZXJzKQoJCXVybF9oID0gdXJsbGliLnVybG9wZW4ocmVxdWVzdCwgdGltZW91dD1zZWxmLmNvbW11bmljYXRpb25fdGltZW91dCkKCQlyZXNwb25zZSA9IHVybF9oLnJlYWQoKQoKCWRlZiBwYXRjaF91cmlfcGF0aChzZWxmLCBuZXdfcGF0aCk6CgkJbWF0Y2ggPSByZS5tYXRjaChyJ2h0dHBzPzovL1teL10rKC8uKiQpJywgc2VsZi51cmwpCgkJaWYgbWF0Y2ggaXMgTm9uZToKCQkJcmV0dXJuIEZhbHNlCgkJc2VsZi51cmwgPSBzZWxmLnVybFs6bWF0Y2guc3BhbigxKVswXV0gKyBuZXdfcGF0aAoJCXJldHVybiBUcnVlCgoJZGVmIHRsdl9wYWNrX3RyYW5zcG9ydF9ncm91cChzZWxmKToKCQl0cmFuc19ncm91cCAgPSBzdXBlcihIdHRwVHJhbnNwb3J0LCBzZWxmKS50bHZfcGFja190cmFuc3BvcnRfZ3JvdXAoKQoJCWlmIHNlbGYudXNlcl9hZ2VudDoKCQkJdHJhbnNfZ3JvdXAgKz0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfVUEsIHNlbGYudXNlcl9hZ2VudCkKCQlpZiBzZWxmLnByb3h5OgoJCQl0cmFuc19ncm91cCArPSB0bHZfcGFjayhUTFZfVFlQRV9UUkFOU19QUk9YWV9IT1NULCBzZWxmLnByb3h5KQoJCXJldHVybiB0cmFuc19ncm91cAoKY2xhc3MgVGNwVHJhbnNwb3J0KFRyYW5zcG9ydCk6CglkZWYgX19pbml0X18oc2VsZiwgdXJsLCBzb2NrZXQ9Tm9uZSk6CgkJc3VwZXIoVGNwVHJhbnNwb3J0LCBzZWxmKS5fX2luaXRfXygpCgkJc2VsZi51cmwgPSB1cmwKCQlzZWxmLnNvY2tldCA9IHNvY2tldAoJCXNlbGYuX2NsZWFudXBfdGhyZWFkID0gTm9uZQoJCXNlbGYuX2ZpcnN0X3BhY2tldCA9IFRydWUKCglkZWYgX3NvY2tfY2xlYW51cChzZWxmLCBzb2NrKToKCQlyZW1haW5pbmdfdGltZSA9IHNlbGYuY29tbXVuaWNhdGlvbl90aW1lb3V0CgkJd2hpbGUgcmVtYWluaW5nX3RpbWUgPiAwOgoJCQlpdGVyX3N0YXJ0X3RpbWUgPSB0aW1lLnRpbWUoKQoJCQlpZiBzZWxlY3Quc2VsZWN0KFtzb2NrXSwgW10sIFtdLCByZW1haW5pbmdfdGltZSlbMF06CgkJCQlpZiBsZW4oc29jay5yZWN2KDQwOTYpKSA9PSAwOgoJCQkJCWJyZWFrCgkJCXJlbWFpbmluZ190aW1lIC09IHRpbWUudGltZSgpIC0gaXRlcl9zdGFydF90aW1lCgkJc29jay5jbG9zZSgpCgoJZGVmIF9hY3RpdmF0ZShzZWxmKToKCQlhZGRyZXNzLCBwb3J0ID0gc2VsZi51cmxbNjpdLnJzcGxpdCgnOicsIDEpCgkJcG9ydCA9IGludChwb3J0LnJzdHJpcCgnLycpKQoJCXRpbWVvdXQgPSBtYXgoc2VsZi5jb21tdW5pY2F0aW9uX3RpbWVvdXQsIDMwKQoJCWlmIGFkZHJlc3MgaW4gKCcnLCAnMC4wLjAuMCcsICc6OicpOgoJCQl0cnk6CgkJCQlzZXJ2ZXJfc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQ2LCBzb2NrZXQuU09DS19TVFJFQU0pCgkJCQlzZXJ2ZXJfc29jay5zZXRzb2Nrb3B0KHNvY2tldC5JUFBST1RPX0lQVjYsIHNvY2tldC5JUFY2X1Y2T05MWSwgMCkKCQkJZXhjZXB0IChBdHRyaWJ1dGVFcnJvciwgc29ja2V0LmVycm9yKToKCQkJCXNlcnZlcl9zb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQoJCQlzZXJ2ZXJfc29jay5iaW5kKCgnJywgcG9ydCkpCgkJCXNlcnZlcl9zb2NrLmxpc3RlbigxKQoJCQlpZiBub3Qgc2VsZWN0LnNlbGVjdChbc2VydmVyX3NvY2tdLCBbXSwgW10sIHRpbWVvdXQpWzBdOgoJCQkJc2VydmVyX3NvY2suY2xvc2UoKQoJCQkJcmV0dXJuIEZhbHNlCgkJCXNvY2ssIF8gPSBzZXJ2ZXJfc29jay5hY2NlcHQoKQoJCQlzZXJ2ZXJfc29jay5jbG9zZSgpCgkJZWxzZToKCQkJaWYgJzonIGluIGFkZHJlc3M6CgkJCQlzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVDYsIHNvY2tldC5TT0NLX1NUUkVBTSkKCQkJZWxzZToKCQkJCXNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCgkJCXNvY2suc2V0dGltZW91dCh0aW1lb3V0KQoJCQlzb2NrLmNvbm5lY3QoKGFkZHJlc3MsIHBvcnQpKQoJCQlzb2NrLnNldHRpbWVvdXQoTm9uZSkKCQlzZWxmLnNvY2tldCA9IHNvY2sKCQlzZWxmLl9maXJzdF9wYWNrZXQgPSBUcnVlCgkJcmV0dXJuIFRydWUKCglkZWYgX2RlYWN0aXZhdGUoc2VsZik6CgkJY2xlYW51cCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbGYuX3NvY2tfY2xlYW51cCwgYXJncz0oc2VsZi5zb2NrZXQsKSkKCQljbGVhbnVwLnJ1bigpCgkJc2VsZi5zb2NrZXQgPSBOb25lCgoJZGVmIF9nZXRfcGFja2V0KHNlbGYpOgoJCWZpcnN0ID0gc2VsZi5fZmlyc3RfcGFja2V0CgkJc2VsZi5fZmlyc3RfcGFja2V0ID0gRmFsc2UKCQlpZiBub3Qgc2VsZWN0LnNlbGVjdChbc2VsZi5zb2NrZXRdLCBbXSwgW10sIDAuNSlbMF06CgkJCXJldHVybiAnJwoJCXBhY2tldCA9IHNlbGYuc29ja2V0LnJlY3YoMTIpCgkJaWYgcGFja2V0ID09ICcnOiAgIyByZW1vdGUgaXMgY2xvc2VkCgkJCXNlbGYucmVxdWVzdF9yZXRpcmUgPSBUcnVlCgkJCXJldHVybiBOb25lCgkJaWYgbGVuKHBhY2tldCkgIT0gMTI6CgkJCWlmIGZpcnN0IGFuZCBsZW4ocGFja2V0KSA9PSA0OgoJCQkJcmVjZWl2ZWQgPSAwCgkJCQloZWFkZXIgPSBwYWNrZXRbOjRdCgkJCQlwa3RfbGVuZ3RoID0gc3RydWN0LnVucGFjaygnPkknLCBoZWFkZXIpWzBdCgkJCQlzZWxmLnNvY2tldC5zZXR0aW1lb3V0KG1heChzZWxmLmNvbW11bmljYXRpb25fdGltZW91dCwgMzApKQoJCQkJd2hpbGUgcmVjZWl2ZWQgPCBwa3RfbGVuZ3RoOgoJCQkJCXJlY2VpdmVkICs9IGxlbihzZWxmLnNvY2tldC5yZWN2KHBrdF9sZW5ndGggLSByZWNlaXZlZCkpCgkJCQlzZWxmLnNvY2tldC5zZXR0aW1lb3V0KE5vbmUpCgkJCQlyZXR1cm4gc2VsZi5fZ2V0X3BhY2tldCgpCgkJCXJldHVybiBOb25lCgoJCXhvcl9rZXkgPSBzdHJ1Y3QudW5wYWNrKCdCQkJCJywgcGFja2V0Wzo0XVs6Oi0xXSkKCQloZWFkZXIgPSB4b3JfYnl0ZXMoeG9yX2tleSwgcGFja2V0WzQ6MTJdKQoJCXBrdF9sZW5ndGgsIHBrdF90eXBlID0gc3RydWN0LnVucGFjaygnPklJJywgaGVhZGVyKQoJCXBrdF9sZW5ndGggLT0gOAoJCXBhY2tldCA9IGJ5dGVzKCkKCQl3aGlsZSBsZW4ocGFja2V0KSA8IHBrdF9sZW5ndGg6CgkJCXBhY2tldCArPSBzZWxmLnNvY2tldC5yZWN2KHBrdF9sZW5ndGggLSBsZW4ocGFja2V0KSkKCQlyZXR1cm4geG9yX2J5dGVzKHhvcl9rZXksIHBhY2tldCkKCglkZWYgX3NlbmRfcGFja2V0KHNlbGYsIHBhY2tldCk6CgkJc2VsZi5zb2NrZXQuc2VuZChwYWNrZXQpCgoJQGNsYXNzbWV0aG9kCglkZWYgZnJvbV9zb2NrZXQoY2xzLCBzb2NrKToKCQl1cmwgPSAndGNwOi8vJwoJCWFkZHJlc3MsIHBvcnQgPSBzb2NrLmdldHNvY2tuYW1lKClbOjJdCgkJIyB0aGlzIHdpbGwgbmVlZCB0byBiZSBjaGFuZ2VkIGlmIHRoZSBiaW5kIHN0YWdlciBldmVyIHN1cHBvcnRzIGJpbmRpbmcgdG8gYSBzcGVjaWZpYyBhZGRyZXNzCgkJaWYgbm90IGFkZHJlc3MgaW4gKCcnLCAnMC4wLjAuMCcsICc6OicpOgoJCQlhZGRyZXNzLCBwb3J0ID0gc29jay5nZXRwZWVybmFtZSgpWzoyXQoJCXVybCArPSBhZGRyZXNzICsgJzonICsgc3RyKHBvcnQpCgkJcmV0dXJuIGNscyh1cmwsIHNvY2spCgpjbGFzcyBQeXRob25NZXRlcnByZXRlcihvYmplY3QpOgoJZGVmIF9faW5pdF9fKHNlbGYsIHRyYW5zcG9ydCk6CgkJc2VsZi50cmFuc3BvcnQgPSB0cmFuc3BvcnQKCQlzZWxmLnJ1bm5pbmcgPSBGYWxzZQoJCXNlbGYubGFzdF9yZWdpc3RlcmVkX2V4dGVuc2lvbiA9IE5vbmUKCQlzZWxmLmV4dGVuc2lvbl9mdW5jdGlvbnMgPSB7fQoJCXNlbGYuY2hhbm5lbHMgPSB7fQoJCXNlbGYubmV4dF9jaGFubmVsX2lkID0gMQoJCXNlbGYuaW50ZXJhY3RfY2hhbm5lbHMgPSBbXQoJCXNlbGYucHJvY2Vzc2VzID0ge30KCQlzZWxmLm5leHRfcHJvY2Vzc19pZCA9IDEKCQlzZWxmLnRyYW5zcG9ydHMgPSBbc2VsZi50cmFuc3BvcnRdCgkJc2VsZi5zZXNzaW9uX2V4cGlyeV90aW1lID0gU0VTU0lPTl9FWFBJUkFUSU9OX1RJTUVPVVQKCQlzZWxmLnNlc3Npb25fZXhwaXJ5X2VuZCA9IHRpbWUudGltZSgpICsgc2VsZi5zZXNzaW9uX2V4cGlyeV90aW1lCgkJZm9yIGZ1bmMgaW4gbGlzdChmaWx0ZXIobGFtYmRhIHg6IHguc3RhcnRzd2l0aCgnX2NvcmUnKSwgZGlyKHNlbGYpKSk6CgkJCXNlbGYuZXh0ZW5zaW9uX2Z1bmN0aW9uc1tmdW5jWzE6XV0gPSBnZXRhdHRyKHNlbGYsIGZ1bmMpCgkJc2VsZi5ydW5uaW5nID0gVHJ1ZQoKCWRlZiByZWdpc3Rlcl9leHRlbnNpb24oc2VsZiwgZXh0ZW5zaW9uX25hbWUpOgoJCXNlbGYubGFzdF9yZWdpc3RlcmVkX2V4dGVuc2lvbiA9IGV4dGVuc2lvbl9uYW1lCgkJcmV0dXJuIHNlbGYubGFzdF9yZWdpc3RlcmVkX2V4dGVuc2lvbgoKCWRlZiByZWdpc3Rlcl9mdW5jdGlvbihzZWxmLCBmdW5jKToKCQlzZWxmLmV4dGVuc2lvbl9mdW5jdGlvbnNbZnVuYy5fX25hbWVfX10gPSBmdW5jCgkJcmV0dXJuIGZ1bmMKCglkZWYgcmVnaXN0ZXJfZnVuY3Rpb25faWYoc2VsZiwgY29uZGl0aW9uKToKCQlpZiBjb25kaXRpb246CgkJCXJldHVybiBzZWxmLnJlZ2lzdGVyX2Z1bmN0aW9uCgkJZWxzZToKCQkJcmV0dXJuIGxhbWJkYSBmdW5jdGlvbjogZnVuY3Rpb24KCglkZWYgcmVnaXN0ZXJfZnVuY3Rpb25fd2luZGxsKHNlbGYsIGZ1bmMpOgoJCWlmIGhhc193aW5kbGw6CgkJCXNlbGYucmVnaXN0ZXJfZnVuY3Rpb24oZnVuYykKCQlyZXR1cm4gZnVuYwoKCWRlZiBhZGRfY2hhbm5lbChzZWxmLCBjaGFubmVsKToKCQlhc3NlcnQoaXNpbnN0YW5jZShjaGFubmVsLCAoc3VicHJvY2Vzcy5Qb3BlbiwgTWV0ZXJwcmV0ZXJGaWxlLCBNZXRlcnByZXRlclNvY2tldCkpKQoJCWlkeCA9IHNlbGYubmV4dF9jaGFubmVsX2lkCgkJc2VsZi5jaGFubmVsc1tpZHhdID0gY2hhbm5lbAoJCWRlYnVnX3ByaW50KCdbKl0gYWRkZWQgY2hhbm5lbCBpZDogJyArIHN0cihpZHgpICsgJyB0eXBlOiAnICsgY2hhbm5lbC5fX2NsYXNzX18uX19uYW1lX18pCgkJc2VsZi5uZXh0X2NoYW5uZWxfaWQgKz0gMQoJCXJldHVybiBpZHgKCglkZWYgYWRkX3Byb2Nlc3Moc2VsZiwgcHJvY2Vzcyk6CgkJaWR4ID0gc2VsZi5uZXh0X3Byb2Nlc3NfaWQKCQlzZWxmLnByb2Nlc3Nlc1tpZHhdID0gcHJvY2VzcwoJCWRlYnVnX3ByaW50KCdbKl0gYWRkZWQgcHJvY2VzcyBpZDogJyArIHN0cihpZHgpKQoJCXNlbGYubmV4dF9wcm9jZXNzX2lkICs9IDEKCQlyZXR1cm4gaWR4CgoJZGVmIGdldF9wYWNrZXQoc2VsZik6CgkJcGt0ID0gc2VsZi50cmFuc3BvcnQuZ2V0X3BhY2tldCgpCgkJaWYgcGt0IGlzIE5vbmUgYW5kIHNlbGYudHJhbnNwb3J0LnNob3VsZF9yZXRpcmU6CgkJCXNlbGYudHJhbnNwb3J0X2NoYW5nZSgpCgkJcmV0dXJuIHBrdAoKCWRlZiBzZW5kX3BhY2tldChzZWxmLCBwYWNrZXQpOgoJCXNlbmRfc3VjY2VlZGVkID0gc2VsZi50cmFuc3BvcnQuc2VuZF9wYWNrZXQocGFja2V0KQoJCWlmIG5vdCBzZW5kX3N1Y2NlZWRlZCBhbmQgc2VsZi50cmFuc3BvcnQuc2hvdWxkX3JldGlyZToKCQkJc2VsZi50cmFuc3BvcnRfY2hhbmdlKCkKCQlyZXR1cm4gc2VuZF9zdWNjZWVkZWQKCglAcHJvcGVydHkKCWRlZiBzZXNzaW9uX2hhc19leHBpcmVkKHNlbGYpOgoJCWlmIHNlbGYuc2Vzc2lvbl9leHBpcnlfdGltZSA9PSAwOgoJCQlyZXR1cm4gRmFsc2UKCQlyZXR1cm4gdGltZS50aW1lKCkgPiBzZWxmLnNlc3Npb25fZXhwaXJ5X2VuZAoKCWRlZiB0cmFuc3BvcnRfYWRkKHNlbGYsIG5ld190cmFuc3BvcnQpOgoJCW5ld19wb3NpdGlvbiA9IHNlbGYudHJhbnNwb3J0cy5pbmRleChzZWxmLnRyYW5zcG9ydCkKCQlzZWxmLnRyYW5zcG9ydHMuaW5zZXJ0KG5ld19wb3NpdGlvbiwgbmV3X3RyYW5zcG9ydCkKCglkZWYgdHJhbnNwb3J0X2NoYW5nZShzZWxmLCBuZXdfdHJhbnNwb3J0PU5vbmUpOgoJCWlmIG5ld190cmFuc3BvcnQgaXMgTm9uZToKCQkJbmV3X3RyYW5zcG9ydCA9IHNlbGYudHJhbnNwb3J0X25leHQoKQoJCXNlbGYudHJhbnNwb3J0LmRlYWN0aXZhdGUoKQoJCWRlYnVnX3ByaW50KCdbKl0gY2hhbmdpbmcgdHJhbnNwb3J0IHRvOiAnICsgbmV3X3RyYW5zcG9ydC51cmwpCgkJd2hpbGUgbm90IG5ld190cmFuc3BvcnQuYWN0aXZhdGUoKToKCQkJbmV3X3RyYW5zcG9ydCA9IHNlbGYudHJhbnNwb3J0X25leHQobmV3X3RyYW5zcG9ydCkKCQkJZGVidWdfcHJpbnQoJ1sqXSBjaGFuZ2luZyB0cmFuc3BvcnQgdG86ICcgKyBuZXdfdHJhbnNwb3J0LnVybCkKCQlzZWxmLnRyYW5zcG9ydCA9IG5ld190cmFuc3BvcnQKCglkZWYgdHJhbnNwb3J0X25leHQoc2VsZiwgY3VycmVudF90cmFuc3BvcnQ9Tm9uZSk6CgkJaWYgY3VycmVudF90cmFuc3BvcnQgaXMgTm9uZToKCQkJY3VycmVudF90cmFuc3BvcnQgPSBzZWxmLnRyYW5zcG9ydAoJCW5ld19pZHggPSBzZWxmLnRyYW5zcG9ydHMuaW5kZXgoY3VycmVudF90cmFuc3BvcnQpICsgMQoJCWlmIG5ld19pZHggPT0gbGVuKHNlbGYudHJhbnNwb3J0cyk6CgkJCW5ld19pZHggPSAwCgkJcmV0dXJuIHNlbGYudHJhbnNwb3J0c1tuZXdfaWR4XQoKCWRlZiB0cmFuc3BvcnRfcHJldihzZWxmLCBjdXJyZW50X3RyYW5zcG9ydD1Ob25lKToKCQlpZiBjdXJyZW50X3RyYW5zcG9ydCBpcyBOb25lOgoJCQljdXJyZW50X3RyYW5zcG9ydCA9IHNlbGYudHJhbnNwb3J0CgkJbmV3X2lkeCA9IHNlbGYudHJhbnNwb3J0cy5pbmRleChjdXJyZW50X3RyYW5zcG9ydCkgLSAxCgkJaWYgbmV3X2lkeCA9PSAtMToKCQkJbmV3X2lkeCA9IGxlbihzZWxmLnRyYW5zcG9ydHMpIC0gMQoJCXJldHVybiBzZWxmLnRyYW5zcG9ydHNbbmV3X2lkeF0KCglkZWYgcnVuKHNlbGYpOgoJCXdoaWxlIHNlbGYucnVubmluZyBhbmQgbm90IHNlbGYuc2Vzc2lvbl9oYXNfZXhwaXJlZDoKCQkJcmVxdWVzdCA9IHNlbGYuZ2V0X3BhY2tldCgpCgkJCWlmIHJlcXVlc3Q6CgkJCQlyZXNwb25zZSA9IHNlbGYuY3JlYXRlX3Jlc3BvbnNlKHJlcXVlc3QpCgkJCQlpZiByZXNwb25zZToKCQkJCQlzZWxmLnNlbmRfcGFja2V0KHJlc3BvbnNlKQoJCQkJY29udGludWUKCQkJIyBpdGVyYXRlIG92ZXIgdGhlIGtleXMgYmVjYXVzZSBzZWxmLmNoYW5uZWxzIGNvdWxkIGJlIG1vZGlmaWVkIGlmIG9uZSBpcyBjbG9zZWQKCQkJY2hhbm5lbF9pZHMgPSBsaXN0KHNlbGYuY2hhbm5lbHMua2V5cygpKQoJCQlmb3IgY2hhbm5lbF9pZCBpbiBjaGFubmVsX2lkczoKCQkJCWNoYW5uZWwgPSBzZWxmLmNoYW5uZWxzW2NoYW5uZWxfaWRdCgkJCQlkYXRhID0gYnl0ZXMoKQoJCQkJaWYgaXNpbnN0YW5jZShjaGFubmVsLCBTVERQcm9jZXNzKToKCQkJCQlpZiBub3QgY2hhbm5lbF9pZCBpbiBzZWxmLmludGVyYWN0X2NoYW5uZWxzOgoJCQkJCQljb250aW51ZQoJCQkJCWlmIGNoYW5uZWwuc3RkZXJyX3JlYWRlci5pc19yZWFkX3JlYWR5KCk6CgkJCQkJCWRhdGEgPSBjaGFubmVsLnN0ZGVycl9yZWFkZXIucmVhZCgpCgkJCQkJZWxpZiBjaGFubmVsLnN0ZG91dF9yZWFkZXIuaXNfcmVhZF9yZWFkeSgpOgoJCQkJCQlkYXRhID0gY2hhbm5lbC5zdGRvdXRfcmVhZGVyLnJlYWQoKQoJCQkJCWVsaWYgY2hhbm5lbC5wb2xsKCkgIT0gTm9uZToKCQkJCQkJc2VsZi5oYW5kbGVfZGVhZF9yZXNvdXJjZV9jaGFubmVsKGNoYW5uZWxfaWQpCgkJCQllbGlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgTWV0ZXJwcmV0ZXJTb2NrZXRDbGllbnQpOgoJCQkJCXdoaWxlIHNlbGVjdC5zZWxlY3QoW2NoYW5uZWwuZmlsZW5vKCldLCBbXSwgW10sIDApWzBdOgoJCQkJCQl0cnk6CgkJCQkJCQlkID0gY2hhbm5lbC5yZWN2KDEpCgkJCQkJCWV4Y2VwdCBzb2NrZXQuZXJyb3I6CgkJCQkJCQlkID0gYnl0ZXMoKQoJCQkJCQlpZiBsZW4oZCkgPT0gMDoKCQkJCQkJCXNlbGYuaGFuZGxlX2RlYWRfcmVzb3VyY2VfY2hhbm5lbChjaGFubmVsX2lkKQoJCQkJCQkJYnJlYWsKCQkJCQkJZGF0YSArPSBkCgkJCQllbGlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgTWV0ZXJwcmV0ZXJTb2NrZXRTZXJ2ZXIpOgoJCQkJCWlmIHNlbGVjdC5zZWxlY3QoW2NoYW5uZWwuZmlsZW5vKCldLCBbXSwgW10sIDApWzBdOgoJCQkJCQkoY2xpZW50X3NvY2ssIGNsaWVudF9hZGRyKSA9IGNoYW5uZWwuYWNjZXB0KCkKCQkJCQkJc2VydmVyX2FkZHIgPSBjaGFubmVsLmdldHNvY2tuYW1lKCkKCQkJCQkJY2xpZW50X2NoYW5uZWxfaWQgPSBzZWxmLmFkZF9jaGFubmVsKE1ldGVycHJldGVyU29ja2V0Q2xpZW50KGNsaWVudF9zb2NrKSkKCQkJCQkJcGt0ICA9IHN0cnVjdC5wYWNrKCc+SScsIFBBQ0tFVF9UWVBFX1JFUVVFU1QpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9NRVRIT0QsICd0Y3BfY2hhbm5lbF9vcGVuJykKCQkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX1VVSUQsIGJpbmFzY2lpLmEyYl9oZXgoYnl0ZXMoUEFZTE9BRF9VVUlELCAnVVRGLTgnKSkpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9DSEFOTkVMX0lELCBjbGllbnRfY2hhbm5lbF9pZCkKCQkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX0NIQU5ORUxfUEFSRU5USUQsIGNoYW5uZWxfaWQpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9MT0NBTF9IT1NULCBpbmV0X3B0b24oY2hhbm5lbC5mYW1pbHksIHNlcnZlcl9hZGRyWzBdKSkKCQkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX0xPQ0FMX1BPUlQsIHNlcnZlcl9hZGRyWzFdKQoJCQkJCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfUEVFUl9IT1NULCBpbmV0X3B0b24oY2xpZW50X3NvY2suZmFtaWx5LCBjbGllbnRfYWRkclswXSkpCgkJCQkJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9QRUVSX1BPUlQsIGNsaWVudF9hZGRyWzFdKQoJCQkJCQlwa3QgID0gc3RydWN0LnBhY2soJz5JJywgbGVuKHBrdCkgKyA0KSArIHBrdAoJCQkJCQlzZWxmLnNlbmRfcGFja2V0KHBrdCkKCQkJCWlmIGRhdGE6CgkJCQkJcGt0ICA9IHN0cnVjdC5wYWNrKCc+SScsIFBBQ0tFVF9UWVBFX1JFUVVFU1QpCgkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX01FVEhPRCwgJ2NvcmVfY2hhbm5lbF93cml0ZScpCgkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX1VVSUQsIGJpbmFzY2lpLmEyYl9oZXgoYnl0ZXMoUEFZTE9BRF9VVUlELCAnVVRGLTgnKSkpCgkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX0NIQU5ORUxfSUQsIGNoYW5uZWxfaWQpCgkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX0NIQU5ORUxfREFUQSwgZGF0YSkKCQkJCQlwa3QgKz0gdGx2X3BhY2soVExWX1RZUEVfTEVOR1RILCBsZW4oZGF0YSkpCgkJCQkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX1JFUVVFU1RfSUQsIGdlbmVyYXRlX3JlcXVlc3RfaWQoKSkKCQkJCQlwa3QgID0gc3RydWN0LnBhY2soJz5JJywgbGVuKHBrdCkgKyA0KSArIHBrdAoJCQkJCXNlbGYuc2VuZF9wYWNrZXQocGt0KQoKCWRlZiBoYW5kbGVfZGVhZF9yZXNvdXJjZV9jaGFubmVsKHNlbGYsIGNoYW5uZWxfaWQpOgoJCWRlbCBzZWxmLmNoYW5uZWxzW2NoYW5uZWxfaWRdCgkJaWYgY2hhbm5lbF9pZCBpbiBzZWxmLmludGVyYWN0X2NoYW5uZWxzOgoJCQlzZWxmLmludGVyYWN0X2NoYW5uZWxzLnJlbW92ZShjaGFubmVsX2lkKQoJCXBrdCAgPSBzdHJ1Y3QucGFjaygnPkknLCBQQUNLRVRfVFlQRV9SRVFVRVNUKQoJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9NRVRIT0QsICdjb3JlX2NoYW5uZWxfY2xvc2UnKQoJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9VVUlELCBiaW5hc2NpaS5hMmJfaGV4KGJ5dGVzKFBBWUxPQURfVVVJRCwgJ1VURi04JykpKQoJCXBrdCArPSB0bHZfcGFjayhUTFZfVFlQRV9SRVFVRVNUX0lELCBnZW5lcmF0ZV9yZXF1ZXN0X2lkKCkpCgkJcGt0ICs9IHRsdl9wYWNrKFRMVl9UWVBFX0NIQU5ORUxfSUQsIGNoYW5uZWxfaWQpCgkJcGt0ICA9IHN0cnVjdC5wYWNrKCc+SScsIGxlbihwa3QpICsgNCkgKyBwa3QKCQlzZWxmLnNlbmRfcGFja2V0KHBrdCkKCglkZWYgX2NvcmVfc2V0X3V1aWQoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCW5ld191dWlkID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVVVJRCkKCQlpZiBuZXdfdXVpZDoKCQkJUEFZTE9BRF9VVUlEID0gYmluYXNjaWkuYjJhX2hleChuZXdfdXVpZFsndmFsdWUnXSkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfZW51bWV4dGNtZChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJZXh0ZW5zaW9uX25hbWUgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9TVFJJTkcpWyd2YWx1ZSddCgkJZm9yIGZ1bmNfbmFtZSBpbiBzZWxmLmV4dGVuc2lvbl9mdW5jdGlvbnMua2V5cygpOgoJCQlpZiBmdW5jX25hbWUuc3BsaXQoJ18nLCAxKVswXSA9PSBleHRlbnNpb25fbmFtZToKCQkJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX1NUUklORywgZnVuY19uYW1lKQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV9tYWNoaW5lX2lkKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQlzZXJpYWwgPSAnJwoJCW1hY2hpbmVfbmFtZSA9IHBsYXRmb3JtLnVuYW1lKClbMV0KCQlpZiBoYXNfd2luZGxsOgoJCQlmcm9tIGN0eXBlcyBpbXBvcnQgd2ludHlwZXMKCgkJCWszMiA9IGN0eXBlcy53aW5kbGwua2VybmVsMzIKCQkJc3lzX2RpciA9IGN0eXBlcy5jcmVhdGVfdW5pY29kZV9idWZmZXIoMjYwKQoJCQlpZiBub3QgazMyLkdldFN5c3RlbURpcmVjdG9yeVcoY3R5cGVzLmJ5cmVmKHN5c19kaXIpLCAyNjApOgoJCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkVfV0lORE9XUwoKCQkJdm9sX2J1ZiA9IGN0eXBlcy5jcmVhdGVfdW5pY29kZV9idWZmZXIoMjYwKQoJCQlmc19idWYgPSBjdHlwZXMuY3JlYXRlX3VuaWNvZGVfYnVmZmVyKDI2MCkKCQkJc2VyaWFsX251bSA9IHdpbnR5cGVzLkRXT1JEKDApCgoJCQlpZiBub3QgazMyLkdldFZvbHVtZUluZm9ybWF0aW9uVyhjdHlwZXMuY193Y2hhcl9wKHN5c19kaXIudmFsdWVbOjNdKSwKCQkJCQl2b2xfYnVmLCBjdHlwZXMuc2l6ZW9mKHZvbF9idWYpLCBjdHlwZXMuYnlyZWYoc2VyaWFsX251bSksIE5vbmUsCgkJCQkJTm9uZSwgZnNfYnVmLCBjdHlwZXMuc2l6ZW9mKGZzX2J1ZikpOgoJCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkVfV0lORE9XUwoJCQlzZXJpYWxfbnVtID0gc2VyaWFsX251bS52YWx1ZQoJCQlzZXJpYWwgPSAiJTA0eCIgJSAoKHNlcmlhbF9udW0gPj4gMTYpICYgMHhmZmZmKSArICctJyAiJTA0eCIgJSAoc2VyaWFsX251bSAmIDB4ZmZmZikKCQllbHNlOgoJCQlzZXJpYWwgPSBnZXRfaGRkX2xhYmVsKCkKCgkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfTUFDSElORV9JRCwgIiVzOiVzIiAlIChzZXJpYWwsIG1hY2hpbmVfbmFtZSkpCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX25hdGl2ZV9hcmNoKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9TVFJJTkcsIGdldF9uYXRpdmVfYXJjaCgpKQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV9wYXRjaF91cmwoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCWlmIG5vdCBpc2luc3RhbmNlKHNlbGYudHJhbnNwb3J0LCBIdHRwVHJhbnNwb3J0KToKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJbmV3X3VyaV9wYXRoID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfVVJMKVsndmFsdWUnXQoJCWlmIG5vdCBzZWxmLnRyYW5zcG9ydC5wYXRjaF91cmlfcGF0aChuZXdfdXJpX3BhdGgpOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfbG9hZGxpYihzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJZGF0YV90bHYgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9EQVRBKQoJCWlmIChkYXRhX3RsdlsndHlwZSddICYgVExWX01FVEFfVFlQRV9DT01QUkVTU0VEKSA9PSBUTFZfTUVUQV9UWVBFX0NPTVBSRVNTRUQ6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoKCQlzZWxmLmxhc3RfcmVnaXN0ZXJlZF9leHRlbnNpb24gPSBOb25lCgkJc3ltYm9sc19mb3JfZXh0ZW5zaW9ucyA9IHsnbWV0ZXJwcmV0ZXInOnNlbGZ9CgkJc3ltYm9sc19mb3JfZXh0ZW5zaW9ucy51cGRhdGUoRVhQT1JURURfU1lNQk9MUykKCQlpID0gY29kZS5JbnRlcmFjdGl2ZUludGVycHJldGVyKHN5bWJvbHNfZm9yX2V4dGVuc2lvbnMpCgkJaS5ydW5jb2RlKGNvbXBpbGUoZGF0YV90bHZbJ3ZhbHVlJ10sICcnLCAnZXhlYycpKQoJCWV4dGVuc2lvbl9uYW1lID0gc2VsZi5sYXN0X3JlZ2lzdGVyZWRfZXh0ZW5zaW9uCgoJCWlmIGV4dGVuc2lvbl9uYW1lOgoJCQljaGVja19leHRlbnNpb24gPSBsYW1iZGEgeDogeC5zdGFydHN3aXRoKGV4dGVuc2lvbl9uYW1lKQoJCQlsaWJfbWV0aG9kcyA9IGxpc3QoZmlsdGVyKGNoZWNrX2V4dGVuc2lvbiwgbGlzdChzZWxmLmV4dGVuc2lvbl9mdW5jdGlvbnMua2V5cygpKSkpCgkJCWZvciBtZXRob2QgaW4gbGliX21ldGhvZHM6CgkJCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9NRVRIT0QsIG1ldGhvZCkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfc2h1dGRvd24oc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX0JPT0wsIFRydWUpCgkJc2VsZi5ydW5uaW5nID0gRmFsc2UKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfdHJhbnNwb3J0X2FkZChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJbmV3X3RyYW5zcG9ydCA9IFRyYW5zcG9ydC5mcm9tX3JlcXVlc3QocmVxdWVzdCkKCQlzZWxmLnRyYW5zcG9ydF9hZGQobmV3X3RyYW5zcG9ydCkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfdHJhbnNwb3J0X2NoYW5nZShzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJbmV3X3RyYW5zcG9ydCA9IFRyYW5zcG9ydC5mcm9tX3JlcXVlc3QocmVxdWVzdCkKCQlzZWxmLnRyYW5zcG9ydF9hZGQobmV3X3RyYW5zcG9ydCkKCQlzZWxmLnNlbmRfcGFja2V0KHRsdl9wYWNrX3Jlc3BvbnNlKEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlKSkKCQlzZWxmLnRyYW5zcG9ydF9jaGFuZ2UobmV3X3RyYW5zcG9ydCkKCQlyZXR1cm4gTm9uZQoKCWRlZiBfY29yZV90cmFuc3BvcnRfbGlzdChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJaWYgc2VsZi5zZXNzaW9uX2V4cGlyeV90aW1lID4gMDoKCQkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfU0VTU0lPTl9FWFAsIHNlbGYuc2Vzc2lvbl9leHBpcnlfZW5kIC0gdGltZS50aW1lKCkpCgkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfR1JPVVAsIHNlbGYudHJhbnNwb3J0LnRsdl9wYWNrX3RyYW5zcG9ydF9ncm91cCgpKQoKCQl0cmFuc3BvcnQgPSBzZWxmLnRyYW5zcG9ydF9uZXh0KCkKCQl3aGlsZSB0cmFuc3BvcnQgIT0gc2VsZi50cmFuc3BvcnQ6CgkJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX1RSQU5TX0dST1VQLCB0cmFuc3BvcnQudGx2X3BhY2tfdHJhbnNwb3J0X2dyb3VwKCkpCgkJCXRyYW5zcG9ydCA9IHNlbGYudHJhbnNwb3J0X25leHQodHJhbnNwb3J0KQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV90cmFuc3BvcnRfbmV4dChzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJbmV3X3RyYW5zcG9ydCA9IHNlbGYudHJhbnNwb3J0X25leHQoKQoJCWlmIG5ld190cmFuc3BvcnQgPT0gc2VsZi50cmFuc3BvcnQ6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCXNlbGYuc2VuZF9wYWNrZXQodGx2X3BhY2tfcmVzcG9uc2UoRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UpKQoJCXNlbGYudHJhbnNwb3J0X2NoYW5nZShuZXdfdHJhbnNwb3J0KQoJCXJldHVybiBOb25lCgoJZGVmIF9jb3JlX3RyYW5zcG9ydF9wcmV2KHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQluZXdfdHJhbnNwb3J0ID0gc2VsZi50cmFuc3BvcnRfcHJldigpCgkJaWYgbmV3X3RyYW5zcG9ydCA9PSBzZWxmLnRyYW5zcG9ydDoKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJc2VsZi5zZW5kX3BhY2tldCh0bHZfcGFja19yZXNwb25zZShFUlJPUl9TVUNDRVNTLCByZXNwb25zZSkpCgkJc2VsZi50cmFuc3BvcnRfY2hhbmdlKG5ld190cmFuc3BvcnQpCgkJcmV0dXJuIE5vbmUKCglkZWYgX2NvcmVfdHJhbnNwb3J0X3JlbW92ZShzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJdXJsID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfVVJMKVsndmFsdWUnXQoJCWlmIHNlbGYudHJhbnNwb3J0LnVybCA9PSB1cmw6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCXRyYW5zcG9ydF9mb3VuZCA9IEZhbHNlCgkJZm9yIHRyYW5zcG9ydCBpbiBzZWxmLnRyYW5zcG9ydHM6CgkJCWlmIHRyYW5zcG9ydC51cmwgPT0gdXJsOgoJCQkJdHJhbnNwb3J0X2ZvdW5kID0gVHJ1ZQoJCQkJYnJlYWsKCQlpZiB0cmFuc3BvcnRfZm91bmQ6CgkJCXNlbGYudHJhbnNwb3J0cy5yZW1vdmUodHJhbnNwb3J0KQoJCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCglkZWYgX2NvcmVfdHJhbnNwb3J0X3NldF90aW1lb3V0cyhzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJdGltZW91dF92YWx1ZSA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX1NFU1NJT05fRVhQKS5nZXQoJ3ZhbHVlJykKCQlpZiBub3QgdGltZW91dF92YWx1ZSBpcyBOb25lOgoJCQlzZWxmLnNlc3Npb25fZXhwaXJ5X3RpbWUgPSB0aW1lb3V0X3ZhbHVlCgkJCXNlbGYuc2Vzc2lvbl9leHBpcnlfZW5kID0gdGltZS50aW1lKCkgKyBzZWxmLnNlc3Npb25fZXhwaXJ5X3RpbWUKCQl0aW1lb3V0X3ZhbHVlID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfVFJBTlNfQ09NTV9USU1FT1VUKS5nZXQoJ3ZhbHVlJykKCQlpZiB0aW1lb3V0X3ZhbHVlOgoJCQlzZWxmLnRyYW5zcG9ydC5jb21tdW5pY2F0aW9uX3RpbWVvdXQgPSB0aW1lb3V0X3ZhbHVlCgkJcmV0cnlfdmFsdWUgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19SRVRSWV9UT1RBTCkuZ2V0KCd2YWx1ZScpCgkJaWYgcmV0cnlfdmFsdWU6CgkJCXNlbGYudHJhbnNwb3J0LnJldHJ5X3RvdGFsID0gcmV0cnlfdmFsdWUKCQlyZXRyeV92YWx1ZSA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX1RSQU5TX1JFVFJZX1dBSVQpLmdldCgndmFsdWUnKQoJCWlmIHJldHJ5X3ZhbHVlOgoJCQlzZWxmLnRyYW5zcG9ydC5yZXRyeV93YWl0ID0gcmV0cnlfdmFsdWUKCgkJaWYgc2VsZi5zZXNzaW9uX2V4cGlyeV90aW1lID4gMDoKCQkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfVFJBTlNfU0VTU0lPTl9FWFAsIHNlbGYuc2Vzc2lvbl9leHBpcnlfZW5kIC0gdGltZS50aW1lKCkpCgkJcmVzcG9uc2UgKz0gc2VsZi50cmFuc3BvcnQudGx2X3BhY2tfdGltZW91dHMoKQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV90cmFuc3BvcnRfc2xlZXAoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCXNlY29uZHMgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9UUkFOU19DT01NX1RJTUVPVVQpWyd2YWx1ZSddCgkJc2VsZi5zZW5kX3BhY2tldCh0bHZfcGFja19yZXNwb25zZShFUlJPUl9TVUNDRVNTLCByZXNwb25zZSkpCgkJaWYgc2Vjb25kczoKCQkJc2VsZi50cmFuc3BvcnQuZGVhY3RpdmF0ZSgpCgkJCXRpbWUuc2xlZXAoc2Vjb25kcykKCQkJaWYgbm90IHNlbGYudHJhbnNwb3J0LmFjdGl2YXRlKCk6CgkJCQlzZWxmLnRyYW5zcG9ydF9jaGFuZ2UoKQoJCXJldHVybiBOb25lCgoJZGVmIF9jb3JlX2NoYW5uZWxfb3BlbihzZWxmLCByZXF1ZXN0LCByZXNwb25zZSk6CgkJY2hhbm5lbF90eXBlID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfQ0hBTk5FTF9UWVBFKQoJCWhhbmRsZXIgPSAnY2hhbm5lbF9vcGVuXycgKyBjaGFubmVsX3R5cGVbJ3ZhbHVlJ10KCQlpZiBoYW5kbGVyIG5vdCBpbiBzZWxmLmV4dGVuc2lvbl9mdW5jdGlvbnM6CgkJCXJldHVybiBlcnJvcl9yZXN1bHQoTm90SW1wbGVtZW50ZWRFcnJvciksIHJlc3BvbnNlCgkJaGFuZGxlciA9IHNlbGYuZXh0ZW5zaW9uX2Z1bmN0aW9uc1toYW5kbGVyXQoJCXJldHVybiBoYW5kbGVyKHJlcXVlc3QsIHJlc3BvbnNlKQoKCWRlZiBfY29yZV9jaGFubmVsX2Nsb3NlKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQljaGFubmVsX2lkID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfQ0hBTk5FTF9JRClbJ3ZhbHVlJ10KCQlpZiBjaGFubmVsX2lkIG5vdCBpbiBzZWxmLmNoYW5uZWxzOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQljaGFubmVsID0gc2VsZi5jaGFubmVsc1tjaGFubmVsX2lkXQoJCWlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgc3VicHJvY2Vzcy5Qb3Blbik6CgkJCWNoYW5uZWwua2lsbCgpCgkJZWxpZiBpc2luc3RhbmNlKGNoYW5uZWwsIE1ldGVycHJldGVyRmlsZSk6CgkJCWNoYW5uZWwuY2xvc2UoKQoJCWVsaWYgaXNpbnN0YW5jZShjaGFubmVsLCBNZXRlcnByZXRlclNvY2tldCk6CgkJCWNoYW5uZWwuY2xvc2UoKQoJCWVsc2U6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCWRlbCBzZWxmLmNoYW5uZWxzW2NoYW5uZWxfaWRdCgkJaWYgY2hhbm5lbF9pZCBpbiBzZWxmLmludGVyYWN0X2NoYW5uZWxzOgoJCQlzZWxmLmludGVyYWN0X2NoYW5uZWxzLnJlbW92ZShjaGFubmVsX2lkKQoJCWRlYnVnX3ByaW50KCdbKl0gY2xvc2VkIGFuZCByZW1vdmVkIGNoYW5uZWwgaWQ6ICcgKyBzdHIoY2hhbm5lbF9pZCkpCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX2NoYW5uZWxfZW9mKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQljaGFubmVsX2lkID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfQ0hBTk5FTF9JRClbJ3ZhbHVlJ10KCQlpZiBjaGFubmVsX2lkIG5vdCBpbiBzZWxmLmNoYW5uZWxzOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQljaGFubmVsID0gc2VsZi5jaGFubmVsc1tjaGFubmVsX2lkXQoJCXJlc3VsdCA9IEZhbHNlCgkJaWYgaXNpbnN0YW5jZShjaGFubmVsLCBNZXRlcnByZXRlckZpbGUpOgoJCQlyZXN1bHQgPSBjaGFubmVsLnRlbGwoKSA+PSBvcy5mc3RhdChjaGFubmVsLmZpbGVubygpKS5zdF9zaXplCgkJcmVzcG9uc2UgKz0gdGx2X3BhY2soVExWX1RZUEVfQk9PTCwgcmVzdWx0KQoJCXJldHVybiBFUlJPUl9TVUNDRVNTLCByZXNwb25zZQoKCWRlZiBfY29yZV9jaGFubmVsX2ludGVyYWN0KHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQljaGFubmVsX2lkID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfQ0hBTk5FTF9JRClbJ3ZhbHVlJ10KCQlpZiBjaGFubmVsX2lkIG5vdCBpbiBzZWxmLmNoYW5uZWxzOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQljaGFubmVsID0gc2VsZi5jaGFubmVsc1tjaGFubmVsX2lkXQoJCXRvZ2dsZSA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX0JPT0wpWyd2YWx1ZSddCgkJaWYgdG9nZ2xlOgoJCQlpZiBjaGFubmVsX2lkIGluIHNlbGYuaW50ZXJhY3RfY2hhbm5lbHM6CgkJCQlzZWxmLmludGVyYWN0X2NoYW5uZWxzLnJlbW92ZShjaGFubmVsX2lkKQoJCQllbHNlOgoJCQkJc2VsZi5pbnRlcmFjdF9jaGFubmVscy5hcHBlbmQoY2hhbm5lbF9pZCkKCQllbGlmIGNoYW5uZWxfaWQgaW4gc2VsZi5pbnRlcmFjdF9jaGFubmVsczoKCQkJc2VsZi5pbnRlcmFjdF9jaGFubmVscy5yZW1vdmUoY2hhbm5lbF9pZCkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgX2NvcmVfY2hhbm5lbF9yZWFkKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKCQljaGFubmVsX2lkID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfQ0hBTk5FTF9JRClbJ3ZhbHVlJ10KCQlsZW5ndGggPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9MRU5HVEgpWyd2YWx1ZSddCgkJaWYgY2hhbm5lbF9pZCBub3QgaW4gc2VsZi5jaGFubmVsczoKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJY2hhbm5lbCA9IHNlbGYuY2hhbm5lbHNbY2hhbm5lbF9pZF0KCQlkYXRhID0gJycKCQlpZiBpc2luc3RhbmNlKGNoYW5uZWwsIFNURFByb2Nlc3MpOgoJCQlpZiBjaGFubmVsLnBvbGwoKSAhPSBOb25lOgoJCQkJc2VsZi5oYW5kbGVfZGVhZF9yZXNvdXJjZV9jaGFubmVsKGNoYW5uZWxfaWQpCgkJCWlmIGNoYW5uZWwuc3Rkb3V0X3JlYWRlci5pc19yZWFkX3JlYWR5KCk6CgkJCQlkYXRhID0gY2hhbm5lbC5zdGRvdXRfcmVhZGVyLnJlYWQobGVuZ3RoKQoJCWVsaWYgaXNpbnN0YW5jZShjaGFubmVsLCBNZXRlcnByZXRlckZpbGUpOgoJCQlkYXRhID0gY2hhbm5lbC5yZWFkKGxlbmd0aCkKCQllbGlmIGlzaW5zdGFuY2UoY2hhbm5lbCwgTWV0ZXJwcmV0ZXJTb2NrZXQpOgoJCQlkYXRhID0gY2hhbm5lbC5yZWN2KGxlbmd0aCkKCQllbHNlOgoJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQlyZXNwb25zZSArPSB0bHZfcGFjayhUTFZfVFlQRV9DSEFOTkVMX0RBVEEsIGRhdGEpCgkJcmV0dXJuIEVSUk9SX1NVQ0NFU1MsIHJlc3BvbnNlCgoJZGVmIF9jb3JlX2NoYW5uZWxfd3JpdGUoc2VsZiwgcmVxdWVzdCwgcmVzcG9uc2UpOgoJCWNoYW5uZWxfaWQgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9DSEFOTkVMX0lEKVsndmFsdWUnXQoJCWNoYW5uZWxfZGF0YSA9IHBhY2tldF9nZXRfdGx2KHJlcXVlc3QsIFRMVl9UWVBFX0NIQU5ORUxfREFUQSlbJ3ZhbHVlJ10KCQlsZW5ndGggPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9MRU5HVEgpWyd2YWx1ZSddCgkJaWYgY2hhbm5lbF9pZCBub3QgaW4gc2VsZi5jaGFubmVsczoKCQkJcmV0dXJuIEVSUk9SX0ZBSUxVUkUsIHJlc3BvbnNlCgkJY2hhbm5lbCA9IHNlbGYuY2hhbm5lbHNbY2hhbm5lbF9pZF0KCQlsID0gbGVuKGNoYW5uZWxfZGF0YSkKCQlpZiBpc2luc3RhbmNlKGNoYW5uZWwsIHN1YnByb2Nlc3MuUG9wZW4pOgoJCQlpZiBjaGFubmVsLnBvbGwoKSAhPSBOb25lOgoJCQkJc2VsZi5oYW5kbGVfZGVhZF9yZXNvdXJjZV9jaGFubmVsKGNoYW5uZWxfaWQpCgkJCQlyZXR1cm4gRVJST1JfRkFJTFVSRSwgcmVzcG9uc2UKCQkJY2hhbm5lbC53cml0ZShjaGFubmVsX2RhdGEpCgkJZWxpZiBpc2luc3RhbmNlKGNoYW5uZWwsIE1ldGVycHJldGVyRmlsZSk6CgkJCWNoYW5uZWwud3JpdGUoY2hhbm5lbF9kYXRhKQoJCWVsaWYgaXNpbnN0YW5jZShjaGFubmVsLCBNZXRlcnByZXRlclNvY2tldCk6CgkJCXRyeToKCQkJCWwgPSBjaGFubmVsLnNlbmQoY2hhbm5lbF9kYXRhKQoJCQlleGNlcHQgc29ja2V0LmVycm9yOgoJCQkJY2hhbm5lbC5jbG9zZSgpCgkJCQlzZWxmLmhhbmRsZV9kZWFkX3Jlc291cmNlX2NoYW5uZWwoY2hhbm5lbF9pZCkKCQkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCWVsc2U6CgkJCXJldHVybiBFUlJPUl9GQUlMVVJFLCByZXNwb25zZQoJCXJlc3BvbnNlICs9IHRsdl9wYWNrKFRMVl9UWVBFX0xFTkdUSCwgbCkKCQlyZXR1cm4gRVJST1JfU1VDQ0VTUywgcmVzcG9uc2UKCglkZWYgY3JlYXRlX3Jlc3BvbnNlKHNlbGYsIHJlcXVlc3QpOgoJCXJlc3AgPSBzdHJ1Y3QucGFjaygnPkknLCBQQUNLRVRfVFlQRV9SRVNQT05TRSkKCQltZXRob2RfdGx2ID0gcGFja2V0X2dldF90bHYocmVxdWVzdCwgVExWX1RZUEVfTUVUSE9EKQoJCXJlc3AgKz0gdGx2X3BhY2sobWV0aG9kX3RsdikKCQlyZXNwICs9IHRsdl9wYWNrKFRMVl9UWVBFX1VVSUQsIGJpbmFzY2lpLmEyYl9oZXgoYnl0ZXMoUEFZTE9BRF9VVUlELCAnVVRGLTgnKSkpCgoJCWhhbmRsZXJfbmFtZSA9IG1ldGhvZF90bHZbJ3ZhbHVlJ10KCQlpZiBoYW5kbGVyX25hbWUgaW4gc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zOgoJCQloYW5kbGVyID0gc2VsZi5leHRlbnNpb25fZnVuY3Rpb25zW2hhbmRsZXJfbmFtZV0KCQkJdHJ5OgoJCQkJZGVidWdfcHJpbnQoJ1sqXSBydW5uaW5nIG1ldGhvZCAnICsgaGFuZGxlcl9uYW1lKQoJCQkJcmVzdWx0ID0gaGFuZGxlcihyZXF1ZXN0LCByZXNwKQoJCQkJaWYgcmVzdWx0IGlzIE5vbmU6CgkJCQkJcmV0dXJuCgkJCQlyZXN1bHQsIHJlc3AgPSByZXN1bHQKCQkJZXhjZXB0IEV4Y2VwdGlvbjoKCQkJCWRlYnVnX3ByaW50KCdbLV0gbWV0aG9kICcgKyBoYW5kbGVyX25hbWUgKyAnIHJlc3VsdGVkIGluIGFuIGVycm9yJykKCQkJCWlmIERFQlVHR0lORzoKCQkJCQl0cmFjZWJhY2sucHJpbnRfZXhjKGZpbGU9c3lzLnN0ZGVycikKCQkJCXJlc3VsdCA9IGVycm9yX3Jlc3VsdCgpCgkJCWVsc2U6CgkJCQlpZiByZXN1bHQgIT0gRVJST1JfU1VDQ0VTUzoKCQkJCQlkZWJ1Z19wcmludCgnWy1dIG1ldGhvZCAnICsgaGFuZGxlcl9uYW1lICsgJyByZXN1bHRlZCBpbiBlcnJvcjogIycgKyBzdHIocmVzdWx0KSkKCQllbHNlOgoJCQlkZWJ1Z19wcmludCgnWy1dIG1ldGhvZCAnICsgaGFuZGxlcl9uYW1lICsgJyB3YXMgcmVxdWVzdGVkIGJ1dCBkb2VzIG5vdCBleGlzdCcpCgkJCXJlc3VsdCA9IGVycm9yX3Jlc3VsdChOb3RJbXBsZW1lbnRlZEVycm9yKQoKCQlyZXFpZF90bHYgPSBwYWNrZXRfZ2V0X3RsdihyZXF1ZXN0LCBUTFZfVFlQRV9SRVFVRVNUX0lEKQoJCWlmIG5vdCByZXFpZF90bHY6CgkJCXJldHVybgoJCXJlc3AgKz0gdGx2X3BhY2socmVxaWRfdGx2KQoJCXJldHVybiB0bHZfcGFja19yZXNwb25zZShyZXN1bHQsIHJlc3ApCgppZiBub3QgaGFzYXR0cihvcywgJ2ZvcmsnKSBvciAoaGFzYXR0cihvcywgJ2ZvcmsnKSBhbmQgb3MuZm9yaygpID09IDApOgoJaWYgaGFzYXR0cihvcywgJ3NldHNpZCcpOgoJCXRyeToKCQkJb3Muc2V0c2lkKCkKCQlleGNlcHQgT1NFcnJvcjoKCQkJcGFzcwoJaWYgSFRUUF9DT05ORUNUSU9OX1VSTCBhbmQgaGFzX3VybGxpYjoKCQl0cmFuc3BvcnQgPSBIdHRwVHJhbnNwb3J0KEhUVFBfQ09OTkVDVElPTl9VUkwsIHByb3h5PUhUVFBfUFJPWFksIHVzZXJfYWdlbnQ9SFRUUF9VU0VSX0FHRU5UKQoJZWxzZToKCQkjIFBBVENILVNFVFVQLVNUQUdFTEVTUy1UQ1AtU09DS0VUICMKCQl0cmFuc3BvcnQgPSBUY3BUcmFuc3BvcnQuZnJvbV9zb2NrZXQocykKCW1ldCA9IFB5dGhvbk1ldGVycHJldGVyKHRyYW5zcG9ydCkKCSMgUEFUQ0gtU0VUVVAtVFJBTlNQT1JUUyAjCgltZXQucnVuKCkK')))